# <a name="troubleshoot-user-errors-with-office-add-ins"></a>Устранение ошибок, с которыми сталкиваются пользователи при работе с надстройками Office

Иногда при работе с вашими надстройками Office пользователи могут столкнуться с определенными проблемами. Например, надстройка может не загружаться или быть недоступной. Эта статья поможет вам устранить распространенные проблемы, с которыми сталкиваются пользователи при работе с вашими надстройками Office. 

Вы также можете воспользоваться сервером [Fiddler](http://www.telerik.com/fiddler), с помощью которого можно определить и устранить проблемы, связанные с надстройками.

Устранив проблему, вы можете [ответить на отзывы пользователей в Магазине Office](https://msdn.microsoft.com/library/jj635874.aspx).

## <a name="common-errors-and-troubleshooting-steps"></a>Распространенные ошибки и устранение неполадок

В таблице ниже перечислены распространенные сообщения об ошибках, с которыми могут столкнуться пользователи, и действия, которые можно предпринять для устранения ошибки.



|**Сообщение об ошибке**|**Решение**|
|:-----|:-----|
|Ошибка приложения: не удалось подключиться к каталогу|Проверьте настройки брандмауэра. Под каталогом понимается Магазин Office. Это сообщение означает, что пользователь не может перейти в Магазин Office.|
|ОШИБКА ПРИЛОЖЕНИЯ: не удается запустить это приложение. Закройте это диалоговое окно, чтобы пропустить ошибку, или нажмите кнопку "Перезагрузка".|Убедитесь, что установлены последние обновления Office, или скачайте [обновление для Office 2013](https://support.microsoft.com/en-us/kb/2986156/).|
|Ошибка: объект не поддерживает свойство или метод "defineProperty"|Убедитесь, что Internet Explorer не работает в режиме совместимости. Откройте меню "Сервис" > **Параметры просмотра в режиме совместимости**.|
|К сожалению, нам не удалось загрузить приложение, так как версия вашего браузера не поддерживается. Щелкните здесь, чтобы просмотреть список поддерживаемых версий браузеров.|Убедитесь, что браузер поддерживает локальное хранилище HTML5, или сбросьте параметры Internet Explorer. Сведения о поддерживаемых браузерах см. в разделе [Требования к запуску надстроек для Office](../../docs/overview/requirements-for-running-office-add-ins.md).|

## <a name="outlook-add-in-doesnt-work-correctly"></a>Надстройка Outlook работает неправильно

Если надстройка Outlook в Windows работает неправильно, попробуйте включить отладку сценариев в Internet Explorer. 


- Откройте меню "Сервис" >  **Свойства браузера** > **Дополнительно**.
    
- В разделе  **Обзор**, снимите флажки  **Отключить отладку сценариев (Internet Explorer)** и **Отключить отладку сценариев (другие)**.
    
Снимать эти флажки рекомендуется только для устранения неполадки. Если они сняты, то при использовании браузера будут появляться соответствующие сообщения. После устранения проблемы снова установите флажки **Отключить отладку сценариев (Internet Explorer)** и **Отключить отладку сценариев (другие)**.


## <a name="add-in-doesnt-activate-in-office-2013"></a>Надстройка не активируется в Office 2013

Если надстройка не активируется при выполнении пользователем следующих действий:


1. выполнении входа с помощью учетной записи Майкрософт в Office 2013;
    
2. включении двухшаговой проверки учетной записи Майкрософт;
    
3. проверки своего удостоверения по запросу при попытке добавления надстройки, —
    
убедитесь, что установлены последние обновления Office, или скачайте [обновление для Office 2013](https://support.microsoft.com/en-us/kb/2986156/).

## <a name="add-in-doesnt-load-in-task-pane-or-other-issues-with-the-add-in-manifest"></a>Надстройка не загружается в область задач или возникают другие проблемы с манифестом надстройки

Сведения об устранении проблем, связанных с манифестом надстройки, см. в статье [Проверка манифеста и устранение связанных с ним неполадок](troubleshoot-manifest.md).

## <a name="add-in-dialog-box-cannot-be-displayed"></a>Не отображается диалоговое окно надстройки

При открытии надстройки Office пользователю будет предложено разрешить отображение диалогового окна. Пользователь выбирает **Разрешить**, и появляется указанное ниже сообщение об ошибке.

"Параметры безопасности браузера не позволили создать диалоговое окно. Используйте другой браузер или настройте браузер так, чтобы [URL-адрес] и домен, отображаемый в адресной строке браузера, находились в одной зоне безопасности."

![Снимок экрана: сообщение об ошибке](http://i.imgur.com/3mqmlgE.png)

|**Браузеры**|**Платформы**|
|:--------------------|:---------------------|
|Internet Explorer, Microsoft Edge|Office Online|

Чтобы решить эту проблему, пользователи или администраторы могут добавить домен надстройки в список надежных сайтов в Internet Explorer или Microsoft Edge.

>**Важно!** Не добавляйте URL-адрес надстройки в список надежных сайтов, если вы не доверяете надстройке.

Чтобы добавить URL-адрес в список надежных сайтов:

1. В Internet Explorer нажмите кнопку "Сервис" и перейдите в раздел **Свойства браузера** > **Безопасность**.
2. Выберите зону **Надежные сайты** и нажмите кнопку **Сайты**.
3. Введите URL-адрес из сообщения об ошибке и нажмите кнопку **Добавить**.
4. Запустите надстройку снова. Если проблема не исчезла, проверьте параметры для других зон безопасности и убедитесь, что домен надстройки находится в той же зоне, что и URL-адрес, отображаемый в адресной строке приложения Office.

Эта проблема возникает при использовании Dialog API в режиме всплывающих окон. Чтобы эта проблема не возникала, используйте флажок [displayInFrame](http://dev.office.com/reference/add-ins/shared/officeui.displaydialogasync). Для этого страница должна поддерживать отображение в окнах iframe. В приведенном ниже примере показано, как использовать флажок.

```js

Office.context.ui.displayDialogAsync(startAddress, {displayInFrame:true}, callback);
```

## <a name="changes-to-add-in-commands-including-ribbon-buttons-and-menu-items-do-not-take-effect"></a>Изменения команд надстройки, включая кнопки ленты и элементы меню, не вступили в силу
Иногда кажется, что изменения таких команд надстройки, как значок для кнопки ленты или текст для элемента меню, не вступили в силу. Очистите старые версии кэша Office.

#### <a name="for-windows"></a>Для Windows
Удалите содержимое папки `%LOCALAPPDATA%\Microsoft\Office\16.0\Wef\`.

#### <a name="for-mac"></a>Для Mac
Удалите содержимое папки `/Users/{your_name_on_the_device}/Library/Containers/com.Microsoft.OsfWebHost/Data/`.

#### <a name="for-ios"></a>Для iOS
Для принудительной перезагрузки вызовите метод JavaScript `window.location.reload(true)` в надстройке. Вы также можете переустановить Office.

## <a name="additional-resources"></a>Дополнительные ресурсы

- [Отладка надстроек в Office Online](../testing/debug-add-ins-in-office-online.md) 
- [Загрузка неопубликованной надстройки Office на iPad и Mac](../testing/sideload-an-office-add-in-on-ipad-and-mac.md)  
- [Отладка надстроек Office на iPad и Mac](../testing/debug-office-add-ins-on-ipad-and-mac.md)  
- [Проверка манифеста и устранение связанных с ним неполадок](troubleshoot-manifest.md)
    

# <a name="validate-and-troubleshoot-issues-with-your-manifest"></a>Проверка манифеста и устранение связанных с ним неполадок

Проверить манифест и устранить связанные с ним неполадки можно с помощью указанных ниже методов. 

- [Проверка манифеста надстроек Office с помощью средства проверки надстроек Office](validate-the-office-add-ins-manifest-against-validator)   
- [Проверка манифеста надстроек Office согласно схеме XML](validate-the-office-add-ins-manifest-against-the-xml-schema)
- [Отладка манифеста для надстройки Office с помощью ведения журнала в среде выполнения](use-runtime-logging-to-debug-the-manifest-for-your-office-add-in)

## <a name="validate-your-manifest-with-the-office-add-in-validator"></a>Проверка манифеста с помощью средства проверки надстроек Office
Чтобы убедиться, что файл манифеста правильно и полностью описывает надстройку Office, проверьте его с помощью [средства проверки надстроек Office](https://github.com/OfficeDev/office-addin-validator).

Для этого выполните следующие действия:

1. Установите [Node.js](https://nodejs.org/download/). 
2. Откройте командную строку / терминал от имени администратора, затем глобально установите средство проверки надстроек с помощью следующей команды:

    ```
    npm install -g office-addin-validator
    ```
    
    > **Примечание.** Если у вас уже установлено приложение Yo Office, обновите его до последней версии, при этом средство проверки будет установлено в качестве зависимости.

3. Для проверки этого этапа выполните команду ниже. Вместо файла MANIFEST.XML укажите путь к XML-файлу манифеста.

    ```
    validate-office-addin MANIFEST.XML
    ```


## <a name="validate-your-manifest-against-the-xml-schema"></a>Проверка манифеста согласно схеме XML

Чтобы убедиться, что файл манифеста соответствует схеме, проведите его проверку на соответствие файлам [определения схемы XML (XSD)](https://github.com/OfficeDev/office-js-docs/tree/master/docs/overview/schemas). Для этой проверки можно использовать средство проверки на соответствие схеме XML. 

Чтобы использовать средство проверки на соответствие схеме XML в командной строке, выполните следующие действия:

1.  Если пока вы не установили [tar](https://www.gnu.org/software/tar/) и [libxml](http://xmlsoft.org/FAQ.html), сделайте это. 
2.  Выполните указанную ниже команду. Замените XSD_FILE на путь к XSD-файлу манифеста, а XML_FILE — на путь к XML-файлу манифеста.
    ```
    xmllint --noout --schema XSD_FILE XML_FILE
    ```

## <a name="use-runtime-logging-to-debug-your-add-in-manifest"></a>Отладка манифеста надстройки с помощью ведения журнала в среде выполнения

Вы можете использовать ведение журнала в среде выполнения для отладки манифеста надстройки Эта функция может помочь вам определять и устранять проблемы с манифестом, которые не обнаруживаются при проверке схемы XSD, например несоответствие идентификаторов ресурсов. Ведение журнала в среде выполнения особенно полезно для отладки надстроек, в которых реализованы команды.  

>**Примечание.** В настоящее время функция ведения журнала в среде выполнения доступна для Office 2016 для настольных систем.

### <a name="turn-on-runtime-logging"></a>Включение ведения журнала в среде выполнения

>**Важно!** Ведение журнала в среде выполнения сказывается на производительности. Включайте его, только если требуется устранить неполадки, связанные с манифестом надстройки.

1. Убедитесь, что у вас установлен Office 2016 для настольных систем сборки **16.0.7019** или выше. 
2. Добавьте раздел реестра `RuntimeLogging` в раздел HKEY_CURRENT_USER\SOFTWARE\Microsoft\Office\16.0\Wef\Developer\'. 
3. В качестве значения по умолчанию задайте полный путь к файлу, в который будет записываться журнал. Пример приведен в архиве [EnableRuntimeLogging.zip](https://github.com/OfficeDev/Office-Add-in-Commands-Samples/raw/master/Tools/RuntimeLogging/EnableRuntimeLogging.zip). 

 > **Примечание.** Необходим готовый каталог, в котором будет создан файл журнала, и соответствующее разрешение на запись. 
 
На приведенном ниже изображении показано, как должен выглядеть реестр. ![Снимок экрана редактора реестра с разделом RuntimeLogging](http://i.imgur.com/Sa9TyI6.png)

Чтобы отключить эту функцию, удалите из реестра раздел `RuntimeLogging`. 

### <a name="troubleshoot-issues-with-your-manifest"></a>Устранение неполадок, связанных с манифестом

Чтобы использовать ведение журнала в среде выполнения для устранения неполадок при загрузке надстройки, сделайте следующее:
 
1. [Загрузите неопубликованную надстройку](sideload-office-add-ins-for-testing.md) для тестирования. 

    >Примечание. Рекомендуем загружать только тестируемую надстройку, чтобы свести к минимуму количество сообщений в файле журнала.
2. Если ничего не происходит и надстройка не отображается в соответствующем диалоговом окне, откройте файл журнала.
3. Выполните в этом файле поиск по идентификатору надстройки, определенному в манифесте. В файле журнала этот идентификатор отмечен как `SolutionId`. 

В приведенном ниже примере файл журнала определяет элемент управления, указывающий на несуществующий файл ресурсов. В этом примере необходимо исправить опечатку в манифесте или добавить недостающий ресурс.

![Снимок экрана с файлом журнала, содержащим запись, которая указывает на несуществующий идентификатор ресурса.](http://i.imgur.com/f8bouLA.png) 

### <a name="known-issues-with-runtime-logging"></a>Известные проблемы с ведением журнала в среде выполнения

В файле журнала могут встречаться непонятные или неправильно классифицированные сообщения. Например:

- сообщение `Medium   Current host not in add-in's host list` с дополнением `Unexpected Parsed manifest targeting different host` неправильно классифицируется как ошибка.
- Если появится сообщение `Unexpected    Add-in is missing required manifest fields  DisplayName`, не содержащее SolutionId, то ошибка, скорее всего, не связана с надстройкой, отладка которой выполняется. 
- Все сообщения `Monitorable` являются ожидаемыми ошибками с точки зрения системы. Иногда они указывают на проблему с манифестом, например опечатку в элементе, которая была пропущена, но не привела к сбою. 

## <a name="clear-the-office-cache"></a>Очистка кэша Office

Если внесенные в манифест изменения (например, имена файлов значков кнопки ленты или текст команд надстроек) не вступили в силу, попробуйте очистить кэш Office на своем компьютере. 

#### <a name="for-windows"></a>Для Windows
Удалите содержимое папки `%LOCALAPPDATA%\Microsoft\Office\16.0\Wef\`.

#### <a name="for-mac"></a>Для Mac
Удалите содержимое папки `/Users/{your_name_on_the_device}/Library/Containers/com.Microsoft.OsfWebHost/Data/`.

#### <a name="for-ios"></a>Для iOS
Для принудительной перезагрузки вызовите метод JavaScript `window.location.reload(true)` в надстройке. Вы также можете переустановить Office.

## <a name="additional-resources"></a>Дополнительные ресурсы

- [XML-манифест надстроек Office](../overview/add-in-manifests.md)
- [Загрузка неопубликованных надстроек Office для тестирования](sideload-office-add-ins-for-testing.md)
- [Отладка надстроек Office](debug-add-ins-using-f12-developer-tools-on-windows-10.md)
# <a name="office-add-in-design-language"></a>Язык дизайна надстроек Office

Язык дизайна Office — это простая визуальная система, которая обеспечивает согласованность всех настроек. Она содержит набор визуальных элементов, определяющих интерфейсы Office, в том числе: 

- стандартный шрифт;
- общая цветовая палитра;
- набор типографских размеров и весов;
- рекомендации по созданию значков;
- общие ресурсы значков;
- определения анимации;
- общие компоненты.

[Office UI Fabric](https://dev.office.com/fabric) — это официальная клиентская платформа для разработки с использованием языка дизайна Office. Использовать платформу Fabric необязательно, но это самый быстрый способ обеспечить полную совместимость надстроек с Office. Воспользуйтесь преимуществами платформы Fabric для проектирования и создания надстроек, расширяющих возможности Office.

Многие надстройки Office связаны с имеющейся фирменной символикой. В надстройке можно сохранить фирменную символику вместе с визуальным языком или языком компонентов. Найдите возможности сохранить собственный визуальный язык, интегрируя надстройку с Office. Рассмотрите возможности изменить цвета, оформление, значки или другие стилистические элементы Office на элементы собственной торговой марки. Рассмотрите способы использования распространенных макетов надстроек или конструктивных шаблонов при вставке элементов управления и компонентов, хорошо знакомых для клиентов.

Вставка фирменного пользовательского интерфейса на основе HTML в пределах системы Office может создавать неудобства для клиентов. Найдите баланс между символикой Office и фирменной символикой вашей компании. Надстройка зачастую не вписывается в Office из-за конфликта между стилистическими элементами. Например, оформление превышает допустимый размер и выходит за пределы сетки, используемые цвета контрастируют или создают сильный шум, анимация избыточна, а ее поведение не соответствует поведению Office. Внешний вид и поведение элементов управления или компонентов значительно отличаются от стандартов Office.

## <a name="typography"></a>Шрифтовое оформление
Segoe — стандартный шрифт для Office. Используйте его в надстройке для совместимости с областями задач Office, диалоговыми окнами и объектами содержимого. Office UI Fabric обеспечивает доступ к шрифту Segoe. В нем представлены все варианты шрифта Segoe (с различной насыщенностью и размером шрифта) в удобных классах CSS. Не все значения размера и насыщенности в Office UI Fabric обеспечат красивый внешний вид в надстройке Office. Для гармоничного размещения элементов и избежания конфликтов рекомендуется использовать подмножество типов Fabric. Ниже приведен список базовых классов Fabric, которые рекомендуется использовать в надстройках Office.

|Пример |Класс |Размер |Насыщенность |Рекомендуемое использование |
|------ |----- |---- |------ |----------------- |
|![Изображение текста баннера](../images/add-in-typeramp-hero.png)|.ms-font-xxl |28 пкс | Segoe Light |<ul><li>Этот класс больше, чем все другие элементы оформления в Office. Используйте его с умом, чтобы избежать нарушения иерархии визуальных компонентов.</li><li>Старайтесь не использовать длинные строки в ограниченном пространстве.</li><li>Оставьте достаточного свободного места вокруг текста при использовании этого класса.</li><li>Обычно используется для сообщений при первом запуске, элементов баннера или других призывов к действию.</li></ul> |
|![Изображение текста баннера](../images/add-in-typeramp-title.png)|.ms-font-xl |21 пкс |Segoe Light | <ul><li>Этот класс соответствует названию области задач приложений Office.</li><li>Используйте его с умом, чтобы избежать горизонтальной иерархии при оформлении.</li><li>Обычно используется для элементов верхнего уровня, таких как название диалогового окна, страницы или содержимого.</li><li></ul> |
|![Изображение текста баннера](../images/add-in-typeramp-subtitle.png)|.ms-font-l |17 пкс |Segoe Semilight | <ul><li>Этот класс располагается на уровень ниже названия.</li><li>Обычно используется для подзаголовка, элемента навигации или заголовка группы.</li><ul> |
|![Изображение текста баннера](../images/add-in-typeramp-body.png)|.ms-font-m |14 пкс |Segoe Regular |* Обычно используется для основного текста внутри надстроек. |
|![Изображение текста баннера](../images/add-in-typeramp-caption.png)|.ms-font-xs |11 пкс | Segoe Regular |* Обычно используется для вторичного или третичного текста, например меток времени, а также для линий, подписей или меток полей. |
|![Изображение текста баннера](../images/add-in-typeramp-annotation.png)|.ms-font-mi |10 пкс |Segoe Semibold |* Шрифт самого маленького размера. Должен использоваться редко. Применим в случаях, когда хорошая читаемость не важна. |
> Цвет текста не включен в эти базовые классы. Для текста на белом фоне в большинстве случаев рекомендуется использовать цвет Fabric "нейтральный первичный".

## <a name="color"></a>Цвет
Цвет часто используется для выделения торговой марки и усиления визуальной иерархии. Он позволяет определить интерфейс, а также предоставить клиентам пошаговые инструкции по его использованию. В Office цвет используется в таких же целях, но применяется только в особенных случаях. Он ни в коем случае не должен превалировать над содержимым клиента. Даже если для каждого приложения Office определен собственный основной цвет, им не следует злоупотреблять.

Office UI Fabric включает набор стандартных цветов темы. Если Fabric применяется в надстройке Office в качестве компонента или входит в ее структуру, рекомендации остаются прежними. Цвет должен отражать иерархию, предлагая пользователям выполнить определенные действия, но не мешая содержимому. Цвета темы Fabric могут предлагать новый цвет элементов общего интерфейса, контрастирующий с фирменной символикой приложения Office и влияющий на иерархию. Другими словами, при использовании внутри надстройки Fabric может изменять цвет элементов общего интерфейса. Этот новый контрастный цвет может отвлекать внимание от общей иерархии и влиять на нее. Необходимо продумать, как избежать подобного влияния и конфликтов. Используйте нейтральные цвета элементов либо измените цвета темы Fabric в соответствии с фирменной символикой приложений Office или собственными фирменными цветами.

С помощью приложений Office клиенты могут персонализировать свои интерфейсы, применив тему пользовательского интерфейса Office. Клиентам доступны четыре темы пользовательского интерфейса, с помощью которых можно изменять стиль фона и кнопок в Word, PowerPoint, Excel и других приложениях в наборе Office. Чтобы обеспечить полную совместимость надстроек с Office и выполнить требования в отношении персонализации, воспользуйтесь нашими API для управления темами. Например, в некоторых темах цвета фона области задач изменяются на темно-серый. Наши API для управления темами позволяют настроить основной текст переднего плана для обеспечения [специальных возможностей](add-in-design-guidelines.md#accessibility-guidelines).

>  Для надстроек почты и области задач используйте свойство [Context.officeTheme](https://dev.office.com/docs/reference/shared/office.context.officetheme.htm), чтобы соответствовать темам приложений Office. Этот API в данный момент доступен только в Office 2016.

> Информацию о контентных надстройках PowerPoint см. в инструкциях по [использованию тем Office в надстройках для PowerPoint](https://dev.office.com/docs/add-ins/powerpoint/use-document-themes-in-your-powerpoint-add-ins.htm).

Учтите следующие общие рекомендации при работе с цветами:

* Используйте цвет с умом для предоставления сведений об иерархии и усиления фирменной символики.
* Злоупотребление отдельным контрастным цветом в интерактивных и неинтерактивных элементах может привести к путанице. Например, не стоит использовать один цвет для выделенных и невыделенных элементов в меню навигации.
* Избегайте ненужных конфликтов с фирменными цветами приложений Office.
* Используйте собственные фирменные цвета для создания ассоциаций с вашей службой или компанией.
* Убедитесь, что весь текст доступен. Убедитесь, что коэффициент контрастности между текстом переднего плана и фоном составляет 4,5:1.
* Помните о цветовой слепоте. Для взаимодействия и обеспечения иерархии используйте не только цвет.
* Ознакомьтесь с [рекомендациями в отношении значков](design-icons.md), чтобы узнать больше о разработке значков команд надстроек с помощью цветовой палитры значков Office.

## <a name="layout"></a>Макет
Для каждого контейнера HTML, внедренного в Office, создается макет. Эти макеты являются основными экранами надстройки. В них создаются интерфейсы, с помощью которых клиенты могут инициировать действия, изменять параметры, а также просматривать и прокручивать содержимое. При разработке надстройки стремитесь, чтобы макеты для разных экранов согласовывались. Это обеспечит преемственность интерфейса. Если имеется веб-сайт, с которым знакомы ваши клиенты, рекомендуется использовать макеты из уже существующих веб-страниц. Настройте их в соответствии с HTML-контейнерами Office.

Рекомендации относительно макета см. в статьях, посвященных использованию [области задач](task-pane-add-ins.md), [содержимого](content-add-ins.md) и [диалоговых окон](dialog-boxes.md). Дополнительные сведения о том, как собрать компоненты Office UI Fabric в общие макеты и интерфейсы пользователя, см. в статье [Шаблоны проектирования интерфейса](ux-design-patterns.md).

Учтите следующие общие рекомендации при работе с макетами:

*    Избегайте узких или широких полей в контейнерах HTML. Рекомендуемое значение по умолчанию: 20 пикселей. 
*    Применяйте принудительное выравнивание элементов. Дополнительные отступы и новые точки выравнивания должны усилить визуальную иерархию.
*    Интерфейсы Office располагаются на сетке с шагом в 4 пикселя. Для заполнения между элементами следует придерживаться коэффициента, кратного 4. 
*    Чрезмерное нагромождение элементов на интерфейсе может привести к путанице и проблемам с сенсорными элементами управления. 
*    Поддерживайте согласованность макетов на экранах. Непредвиденные изменения макета выглядят, как визуальные ошибки, которые подрывают уверенность в вашем решении. 
*    Используйте общие шаблоны макетов. Это облегчает понимание пользовательского интерфейса и упрощает работу с ним.
*    Избегайте переизбытка элементов, таких как фирменная символика или команды.
*    Объединяйте элементы управления и представления, чтобы не слишком часто использовать мышь. 
*    Создавайте гибкие интерфейсы, которые подстраиваются под ширину и высоту контейнера HTML.

## <a name="component-language"></a>Язык компонентов

Экраны и макеты состоят из содержимого и компонентов. Компоненты — это элементы управления, которые помогают клиентам взаимодействовать с элементами программного обеспечения или службы. Кнопки, элементы навигации, эмблемы, оповещения и раскрывающиеся списки — все это примеры общих компонентов, которые часто отличаются единым стилем и поведением.

Office UI Fabric обрабатывает компоненты, обеспечивая их полную совместимость с Office. Воспользуйтесь преимуществами Fabric для легкой интеграции с Office. Если надстройка содержит собственный язык компонентов, не нужно отказываться от него в пользу Fabric. Найдите возможности сохранить его, интегрируя надстройку с Office. Рассмотрите способы изменения стилистических элементов и удаления конфликтов или примените понятные пользователям стили и поведение.

Учтите следующие общие рекомендации при работе с компонентами:

*    Не реплицируйте ленту Office в надстройке.
*    Старайтесь не создавать меню, кнопки или другие элементы, поведение которых отличается от поведения компонентов Office.
*    Используйте компоненты [Office UI Fabric](office-ui-fabric.md), рекомендуемые для надстроек.
*    Используйте [конструктивные шаблоны](ux-design-patterns.md) для общих компонентов пользовательского интерфейса Office. 

## <a name="icons"></a>Значки
Значки — это визуальное представление поведения или концепции. Они часто используются, чтобы отобразить предназначение элементов управления и команд. Визуальные элементы, реалистичные или символистичные, позволяют выполнять навигацию в пользовательском интерфейсе аналогично значкам в среде пользователя. Эти элементы должны быть простыми и четкими, а также содержать только необходимые сведения, чтобы пользователи могли быстро проанализировать, какое действие произойдет при выборе элемента управления.

Интерфейсы ленты Office отличаются стандартным визуальным стилем. Если вы разрабатываете команду надстройки для ленты Office, придерживайтесь наших [рекомендаций в отношении значков](design-icons). Это поможет обеспечить знакомый пользователям единообразный интерфейс для всех приложений Office. Рекомендации помогут вам создать для своего решения набор ресурсов PNG, полностью совместимых с Office.

Многие контейнеры HTML содержат элементы управления со значками. Используйте пользовательский шрифт Office UI Fabric для отрисовки значков в стиле Office в своей надстройке. Шрифт значков Fabric содержит ряд глифов для распространенных метафор Office, к которым можно применить необходимые параметры масштабирования, цвета и стиля. Если у вас имеется визуальный язык с собственным набором значков, используйте его на своем полотне HTML. Обеспечение согласованности собственной фирменной символики со стандартным набором значков — важная часть любого языка дизайна. Не допускайте конфликтов с метафорами Office. Это облегчит работу пользователей и поможет избежать путаницы.

Учтите следующие общие рекомендации при работе со значками:

* Не используйте глифы Office UI Fabric для команд надстроек на ленте Office или в контекстных меню. Значки Fabric имеют собственный стиль, поэтому отличаются от остальных.
* Используйте язык значков Office для представления поведения или концепций.
* Повторно используйте общие визуальные метафоры Office, например кисть для форматирования или увеличительное стекло для поиска.
* Не используйте метафоры применительно к несвязанным действиям. Использование одного визуального элемента для другого поведения или концепции может запутать пользователей.

## <a name="animation"></a>Анимация
Элементы пользовательского интерфейса, элементы управления и компоненты часто отличаются интерактивным поведением, требующим переходов, перемещений или анимации. Общие характеристики перемещения между элементами пользовательского интерфейса определяют свойства анимации языка дизайна. Так как Office ориентирован на производительность, язык анимации Office нацелен в первую очередь на выполнение клиентами своих задач. Он обеспечивает баланс между оперативным ответом, надежной хореографией и удобством использования.

Office UI Fabric включает в себя библиотеку анимации для управления перемещениями в своих контейнерах HTML. Используйте ее для более простой интеграции с Office. Это поможет создавать удобные в работе интерфейсы. Классы CSS анимации обеспечивают направленность, точки входа и выхода, а также длительность, которые усиливают умозрительные модели Office и помогают клиентам научиться взаимодействовать с вашей надстройкой. 

Если надстройка содержит собственный язык анимации, используйте его. Найдите возможности сохранить собственную фирменную анимацию, интегрируя надстройку с Office. Избегайте конфликтов с распространенными шаблонами перемещения в Office. Старайтесь не создавать нефункциональные интерфейсы, которые только отвлекают клиентов.

К анимации применяются следующие общие рекомендации:

* Анимация должна быть понятной на подсознательном уровне, что обеспечит успешное выполнение задач.
* Избегайте упреждения, возвратов, эффекта "резиновой ленты" или других эффектов, которые имитируют законы физики реального мира.
* Спланируйте хореографию элементов, чтобы усилить иерархию и умозрительные модели.
* С помощью перемещения направляйте пользователя, а также указывайте на ключевые элементы, необходимые для завершения задачи. 
* Проанализируйте источник элемента-триггера. С помощью перемещения создайте связь между действием и итоговым пользовательским интерфейсом.
* Учитывайте тон и цель содержимого при выборе анимации. Обрабатывайте критические сообщения не так, как описательные.

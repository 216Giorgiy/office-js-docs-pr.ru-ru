---
title: ?????????????? ???????? ??????? ????? ? ??????????
description: ''
ms.date: 05/02/2018
ms.openlocfilehash: 06e1cce3a45a5af744a1be4b3feabbf051940d76
ms.sourcegitcommit: c72c35e8389c47a795afbac1b2bcf98c8e216d82
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/23/2018
---
# <a name="automatically-open-a-task-pane-with-a-document"></a>?????????????? ???????? ??????? ????? ? ??????????

??????? ? ?????????? Office ????????? ????????? ??????????? ????????????????? ?????????? Office, ???????? ?????? ? ????? Office. ????? ???????????? ???????? ??????, ??????????? ????????? ???????? (????????, ??????????? ??????? ?????). 

? ????????? ????????? ?????????, ????? ??????? ????? ??????????? ????????????? ?????? ? ?????????? ??? ?????? ?????????????? ? ?????????????. ??????? ??????????????? ???????? ??????? ?????, ?????????????? ? ?????? ?????????? AddInCommands 1.1, ????????? ????????????? ????????? ??????? ?????, ???? ??? ????????? ? ????? ????????. 


## <a name="how-is-the-autoopen-feature-different-from-inserting-a-task-pane"></a>??? ??????? ??????????????? ???????? ?????????? ?? ??????? ??????? ?????? 

???? ???????????? ????????? ??????????, ??????? ?? ?????????? ??????? ????????? (????????, ? Office 2013), ??? ??????????? ? ???????? ? ??????????? ? ???. ????? ???????, ??? ???????? ????? ????????? ??????? ??????????????, ?? ????? ?????????? ?????????? ?????????? ? ????????? ??????? ?????. ?????????? ???? ?????? ????? ??????? ? ???, ??? ???????????? ?? ????? ????????? ?????????? ??? ?????????. ????????, ????????, ??????? ?????????? ?????????? ??????? ? ????????? Word, ????? ?? ????????, ????? ??? ????????????? ??? ????????????? ???????? ?????? ?? ????????? ???? ?????????? ??? ???????? ?????????.  

??????? ??????????????? ???????? ????????? ???? ?????????? ??? ???? ?????????? ???????????? ?????????? ????????????? ? ?????????? ?????????? ?????????? ??????? ????? ? ?????????? ?????????. 

## <a name="support-and-availability"></a>????????? ? ???????????
???? ??????????? ???????? ? ?????????, <!-- in **developer preview** and it is only --> ? ??????? ?????????????? ??????? ??????????????? ????????.

|**????????**|**?????????**|
|:-----------|:------------|
|<ul><li> Word</li><li>Excel</li><li>PowerPoint</li></ul>|?????????????? ????????? ??? ???? ?????????:<ul><li>Office ??? Windows Desktop (?????? 16.0.8121.1000 ??? ????? ???????)</li><li>Office ??? Mac (?????? 15.34.17051500 ??? ????? ???????)</li><li>Office Online</li></ul>|


## <a name="best-practices"></a>?????? ? ????????????

??? ????????????? ??????? ??????????????? ???????? ??????????????? ????????? ????????????.

- ??????????? ??????? ??????????????? ????????, ???? ??? ??????? ????????????? ?????? ????????????? ? ???????? ???????:
    - ???? ?????????? ????????? ??? ?????????? ?????? ?????????. ????????, ??? ??????????? ???????, ?????????? ????????? ???????, ??????? ???????????? ??????????? ? ??????? ??????????. ?????????? ?????? ??????????? ????????????? ?????? ? ??????????? ????????, ????? ???????? ???????????? ???????????. 
    - ???? ???????????? ? ??????? ???????????? ?????? ????? ???????????? ??? ?????????? ??? ?????? ? ???????????? ??????????. ??????: ??????????, ??????? ???????? ????????????? ????????? ?????? ? ????????? ??? ??????? ?????????, ???????? ?????????? ?? ????????? ???????. 
- ????????? ????????????? ???????? ? ????????? ??????? ??????????????? ????????. ???????? ???????? ? ????????? ??? ?????????????, ????? ?????????????? ???????? ??????? ????? ?????????? ????? ???? ?????????.  
- ??????????? ???????? ??????????? ?????? ??????????, ????? ?????????? ??????????? ??????? ??????????????? ????????, ? ???????????? ????????? ?????? ??? ?? ??????????.
- ?? ??????????? ??????? ??????????????? ????????, ????? ???????????? ??????????? ?????????? ????????????? ??????????. ???? ?????????????? ???????? ?????????? ??????????????? ??? ???????????? ??????????, ??? ??????? ????? ?????????? ?????????????. 

    > [!NOTE]
    > ???? ?????????? ?????????? ?????????, ??? ??????? ??????????????? ???????? ??????????? ?? ?? ??????????, ???????? ?????????? ????? ?????????? ?? AppSource. 

- ?? ??????????? ??? ???????, ????? ????????? ????????? ???????? ?????. ????? ?????? ?????? ???? ??????? ????? ?????????? ??? ??????????????? ???????? ?????? ? ??????????.  

## <a name="implementation"></a>??????????
????????? ????????? ????????, ????? ???????????? ??????? ??????????????? ????????.

- ??????? ??????? ?????, ??????? ?????????? ????????? ?????????????.
- ???????? ????????, ? ??????? ????? ????????????? ??????????? ??? ??????? ?????.

> [!IMPORTANT]
> ???????, ?????????? ??? ??????????????? ????????, ????? ???????????, ?????? ???? ??????????? ?????????? ??? ???? ?? ?????????? ????????????. ???? ??? ??? ?? ???????????, ??????? ??????????????? ???????? ?? ????????? ??? ???????? ?????????, ? ???????? ????? ??????????????. ????? ?????????? ???????????????? ?????? ? ??????????, ??????? ??? ???????? visibility ???????? 1. ??? ????? ??????? ?????? ? ??????? OpenXML. ??????????????? ?????? ???????? ????. 

### <a name="step-1-specify-the-task-pane-to-open"></a>???? 1. ???????? ??????? ?????, ??????? ?????????? ?????????
????? ??????? ??????? ?????, ??????? ?????????? ????????? ?????????????, ??????? ??? [TaskpaneId](https://dev.office.com/reference/add-ins/manifest/action#taskpaneid) ???????? **Office.AutoShowTaskpaneWithDocument**. ??? ???????? ????? ?????????? ?????? ? ????? ??????? ?????. ???? ?????????? ??? ???????? ??? ?????????? ???????? ?????, ???????????? ?????? ?????? ?????? ??? ?????????????, ? ??? ????????? ????? ??????????????. 

???? ??????????? ??????, ??? ??? TaskPaneId ?????? ???????? Office.AutoShowTaskpaneWithDocument.
          
```xml
<Action xsi:type="ShowTaskpane">
    <TaskpaneId>Office.AutoShowTaskpaneWithDocument</TaskpaneId>
    <SourceLocation resid="Contoso.Taskpane.Url" />
</Action>
```     

### <a name="step-2-tag-the-document-to-automatically-open-the-task-pane"></a>???? 2. ????????? ??????? ??? ?????????, ?????? ? ??????? ????? ????????????? ??????????? ??????? ?????

?? ?????? ???????? ???????? ??? ??????? ??????? ??????????????? ???????? ????? ?? ???? ????????. ???????? ???????, ??????? ????? ????? ???????? ??? ?????? ????????.  


#### <a name="tag-the-document-on-the-client-side"></a>????????? ??????? ??? ????????? ?? ??????? ???????
??????????? ????? Office.js [settings.set](https://dev.office.com/reference/add-ins/shared/settings.set), ????? ?????????? ??? **Office.AutoShowTaskpaneWithDocument** ???????? **true**, ??? ???????? ? ????????? ???????.   

```js
Office.context.document.settings.set("Office.AutoShowTaskpaneWithDocument", true);
Office.context.document.settings.saveAsync();
```

??????????? ???? ?????, ???? ????? ???????? ???????? ? ?????? ?????????????? ? ??????????? (????????, ????? ???????? ????????????? ???????? ??? ?????? ?????????, ?? ?????? ??????? ????????????? ? ?????????????? ???????? ???????).

#### <a name="use-open-xml-to-tag-the-document"></a>????????? ??????? ??? ????????? ? ??????? Open XML
? ??????? Open XML ????? ??????? ???????? ? ??????? ? ???? ?????????, ? ????? ????????? ??????????????? ??????????? ? Open Office XML ??? ??????? ??????? ??????????????? ????????. ?????? ? ???????????? ????, ??? ??? ????? ???????, ??. ? ?????? [Office-OOXML-EmbedAddin](https://github.com/OfficeDev/Office-OOXML-EmbedAddin). 

???????? ? ???????? ??? ????? Open XML:

- ????? webextension;
- ????? taskpane.

? ????????? ??????? ????????, ??? ???????? ????? webextension.

```xml
<we:webextension xmlns:we="http://schemas.microsoft.com/office/webextensions/webextension/2010/11" id="[ADD-IN ID PER MANIFEST]">
  <we:reference id="[GUID or AppSource asset ID]" version="[your add-in version]" store="[Pointer to store or catalog]" storeType="[Store or catalog type]"/>
  <we:alternateReferences/>
  <we:properties>
    <we:property name="Office.AutoShowTaskpaneWithDocument" value="true"/>
  </we:properties>
  <we:bindings/>
  <we:snapshot xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"/>
</we:webextension>
```

????? webextension ???????? ????????? ???????, ? ????? ???????? ??? ????????? **Office.AutoShowTaskpaneWithDocument**, ??? ???????? ?????????? ?????????? ???????? `true`.

????? webextension ????? ???????? ?????? ?? ??????? ??? ??????? ? ?????????? ??? `id`, `storeType`, `store`, ? `version`. ?????? 4 ???????? `storeType` ????????? ? ??????? ??????????????? ????????. ???????? ??? ????????? ???? ????????? ??????? ?? ???????? ??? `storeType`, ??? ???????? ? ??????? ????. 

| **`storeType` ????????** | **`id` ????????**    |**`store` ????????** | **`version` ????????**|
|:---------------|:---------------|:---------------|:---------------|
|OMEX (AppSource)|?? ??????? AppSource ??? ?????????? (??. ??????????)|??? ????? ??? AppSource (????????, "ru-ru").|?????? ???????? AppSource (??. ??????????)|
|FileSystem (??????? ?????)|GUID ?????????? ? ?? ?????????.|???? ? ??????? ????? (????????, "\\\\MyComputer\\MySharedFolder").|?????? ? ????????? ??????????.|
|EXCatalog (????????????? ????? Exchange Server) |GUID ?????????? ? ?? ?????????.|"EXCatalog". ?????? EXCatalog - ??? ??????, ??????? ????? ?????????????? ? ????????????, ????????????? ???????????????? ????????????? ? ???????????????? ?????? Office 365.|?????? ? ????????? ??????????.
|Registry (?????? ???????)|GUID ?????????? ? ?? ?????????.|"???????????"|?????? ? ????????? ??????????.|

> [!NOTE]
> ??? ?????? ?? ??????? ? ?????? ?????????? ? AppSource ????????? ?? ??????? ???????? AppSource ??? ??????????????? ??????????. ?? ??????? ???????????? ? ???????? ?????? ????????. ?????? ??????? ? ??????? **????????** ?? ???? ????????.

?????????????? ???????? ?? ??????????? webextension ??. ? ????????? [[MS-OWEXML] 2.2.5. WebExtensionReference](https://msdn.microsoft.com/en-us/library/hh695383(v=office.12).aspx).

? ????????? ??????? ????????, ??? ???????? ????? taskpane.

```xml
<wetp:taskpane dockstate="right" visibility="0" width="350" row="4" xmlns:wetp="http://schemas.microsoft.com/office/webextensions/taskpanes/2010/11">
  <wetp:webextensionref xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" r:id="rId1" />
</wetp:taskpane>
```

???????? ????????, ??? ? ???? ??????? ??? ???????? `visibility` ??????????? ???????? "0". ??? ????????, ??? ????? ?????????? ?????? webextension ? taskpane ??? ?????? ???????? ????????? ???????????? ?????????? ????? ?????????? ??????????, ????? ?????? **??????????** ?? ?????. ????? ????? ??????? ????? ?????????? ????? ??????????? ????????????? ?????? ? ??????. ????? ????, ???? ?????????? ??? `visibility` ???????? "0", ????? ? ??????? Office.js ???????????? ????????????? ??????????? ???????? ? ????????? ??????? ??????????????? ????????. ? ?????????, ??? ?????? ????????????? ??? ????????? ????????? **Office.AutoShowTaskpaneWithDocument** ???????? `true` ??? `false`. (?????????????? ???????? ??. ? ??????? [????????? ??????? ??? ????????? ?? ??????? ???????](#tag-the-document-on-the-client-side).) 

???? ??? `visibility` ??????????? ???????? "1", ??????? ????? ????????? ????????????? ??? ?????? ???????? ?????????. ???????????? ????? ?????????? ???????? ??????????. ? ?????? ?????????????? ??????? ?????????? ?????????. ????? ????? ??????? ????? ?????????? ????? ??????????? ????????????? ?????? ? ??????. ?????? ???? ?????????? ??? `visibility` ???????? "1", ????? ? ??????? Office.js ???????????? ????????????? ??????????? ???????? ? ????????? ??????? ??????????????? ????????. 

???????? "1" ??????? ???????? ??? ???????? `visibility`, ???? ?????????? ? ?????? ??? ?????????? ????????? ????????????? ????????? ?????, ??? ???????????? ?? ????????? ?? ????????????? ??????? ??????????????? ????????. 

> [!NOTE]
> ???? ?? ?????? ?????????????? ?????????? ?????? ? ??????????, ????? ????????????? ???????????? ?????????? ??, ?????????? ?????? ??? ???????? visibility ???????? 1. ??? ????? ??????? ?????? ????? Open XML.

????? ??????? ?????? ?????? XML ? ??????? ????????? ?????????? ? [???????? ???????? ?? ??????? ???????](#tag-the-document-on-the-client-side), ????? ???????? ????????, ? ????? ????????? ???????? ? ????????? ????????? XML. Office ????????? ? ?????? ??????????????? ???????? ????????. ?????????? [Open XML SDK 2.5 Productivity Tool](https://www.microsoft.com/en-us/download/details.aspx?id=30425) ????? ????? ???????????? ??? ???????? ???? ?? ????? C#, ????? ??????????? ???????? ???????? ??????????? ?? ?????? ???????????? XML.

## <a name="test-and-verify-opening-taskpanes"></a>???????????? ? ???????? ????????????? ??????? ?????
?? ?????? ?????????? ???????? ?????? ????? ??????????, ???????? ????????????? ??????? ?????? ????? ? ??????? ????????????????? ????????????? ????? ??????????????? ????? Office 365. ? ????????? ??????? ????????, ??? ??????????? ?????????? ?? ???????? ????????????????? ????????????? ? ?????????????? ?????? ????????? EXCatalog.

```xml
<we:webextension xmlns:we="http://schemas.microsoft.com/office/webextensions/webextension/2010/11" id="{52811C31-4593-43B8-A697-EB873422D156}">
    <we:reference id="af8fa5ba-4010-4bcc-9e03-a91ddadf6dd3" version="1.0.0.0" store="EXCatalog" storeType="EXCatalog"/>
    <we:alternateReferences/>
    <we:properties/>
    <we:bindings/>
    <we:snapshot xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"/>
</we:webextension>
```
????? ????????? ?????????? ??????, ??.?????? [????????? ????? ?????????? Office 365](https://msdn.microsoft.com/en-us/office/office365/howto/setup-development-environment) ? ?????????????????????? ?????????? [??????? ?????? ???????????? Office 365](https://developer.microsoft.com/en-us/office/dev-program). ?????????? ?? ?????? ?????????? ???????? ?????? ????????????????? ????????????? ? ?????????, ??? ???? ?????????? ???????? ?????????.


## <a name="see-also"></a>??. ?????

?????? ????????????? ??????? ??????????????? ???????? ??. ? ?????? [??????? ?????? ??? ?????????? Office](https://github.com/OfficeDev/Office-Add-in-Commands-Samples/tree/master/AutoOpenTaskpane). 
[??????????????? ? ????????? ???????????? Office 365](https://docs.microsoft.com/en-us/office/developer-program/office-365-developer-program). 


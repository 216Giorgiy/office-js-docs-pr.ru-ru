---
title: ?????????????? ???????? ??????? ????? ? ??????????
description: ''
ms.date: 05/02/2018
ms.openlocfilehash: 06e1cce3a45a5af744a1be4b3feabbf051940d76
ms.sourcegitcommit: c72c35e8389c47a795afbac1b2bcf98c8e216d82
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/23/2018
---
# <a name="automatically-open-a-task-pane-with-a-document"></a><span data-ttu-id="68b6c-102">?????????????? ???????? ??????? ????? ? ??????????</span><span class="sxs-lookup"><span data-stu-id="68b6c-102">Automatically open a task pane with a document</span></span>

<span data-ttu-id="68b6c-p101">??????? ? ?????????? Office ????????? ????????? ??????????? ????????????????? ?????????? Office, ???????? ?????? ? ????? Office. ????? ???????????? ???????? ??????, ??????????? ????????? ???????? (????????, ??????????? ??????? ?????).</span><span class="sxs-lookup"><span data-stu-id="68b6c-p101">You can use add-in commands in your Office Add-in to extend the Office UI by adding buttons to the Office ribbon. When users click your command button, an action occurs, such as opening a task pane.</span></span> 

<span data-ttu-id="68b6c-p102">? ????????? ????????? ?????????, ????? ??????? ????? ??????????? ????????????? ?????? ? ?????????? ??? ?????? ?????????????? ? ?????????????. ??????? ??????????????? ???????? ??????? ?????, ?????????????? ? ?????? ?????????? AddInCommands 1.1, ????????? ????????????? ????????? ??????? ?????, ???? ??? ????????? ? ????? ????????.</span><span class="sxs-lookup"><span data-stu-id="68b6c-p102">Some scenarios require that a task pane open automatically when a document opens, without explicit user interaction. You can use the autoopen taskpane feature, introduced in the AddInCommands 1.1 requirement set, to automatically open a task pane when your scenario requires it.</span></span> 


## <a name="how-is-the-autoopen-feature-different-from-inserting-a-task-pane"></a><span data-ttu-id="68b6c-107">??? ??????? ??????????????? ???????? ?????????? ?? ??????? ??????? ??????</span><span class="sxs-lookup"><span data-stu-id="68b6c-107">How is the autoopen feature different from inserting a task pane?</span></span> 

<span data-ttu-id="68b6c-p103">???? ???????????? ????????? ??????????, ??????? ?? ?????????? ??????? ????????? (????????, ? Office 2013), ??? ??????????? ? ???????? ? ??????????? ? ???. ????? ???????, ??? ???????? ????? ????????? ??????? ??????????????, ?? ????? ?????????? ?????????? ?????????? ? ????????? ??????? ?????. ?????????? ???? ?????? ????? ??????? ? ???, ??? ???????????? ?? ????? ????????? ?????????? ??? ?????????. ????????, ????????, ??????? ?????????? ?????????? ??????? ? ????????? Word, ????? ?? ????????, ????? ??? ????????????? ??? ????????????? ???????? ?????? ?? ????????? ???? ?????????? ??? ???????? ?????????.</span><span class="sxs-lookup"><span data-stu-id="68b6c-p103">When a user launches add-ins that don't use add-in commands - for example, add-ins that run in Office 2013 - they are inserted into the document, and persist in that document. As a result, when other users open the document, they are prompted to install the add-in, and the task pane opens. The challenge with this model is that in many cases, users don?t want the add-in to persist in the document. For example, a student who uses a dictionary add-in in a Word document might not want their classmates or teachers to be prompted to install that add-in when they open the document.</span></span>  

<span data-ttu-id="68b6c-112">??????? ??????????????? ???????? ????????? ???? ?????????? ??? ???? ?????????? ???????????? ?????????? ????????????? ? ?????????? ?????????? ?????????? ??????? ????? ? ?????????? ?????????.</span><span class="sxs-lookup"><span data-stu-id="68b6c-112">With the autoopen feature, you can explicitly define or allow the user to define whether a specific task pane add-in persists in a specific document.</span></span> 

## <a name="support-and-availability"></a><span data-ttu-id="68b6c-113">????????? ? ???????????</span><span class="sxs-lookup"><span data-stu-id="68b6c-113">Support and availability</span></span>
<span data-ttu-id="68b6c-114">???? ??????????? ???????? ? ?????????, <!-- in **developer preview** and it is only --> ? ??????? ?????????????? ??????? ??????????????? ????????.</span><span class="sxs-lookup"><span data-stu-id="68b6c-114">The autoopen feature is currently <!-- in **developer preview** and it is only --> supported in the following products and platforms.</span></span>

|<span data-ttu-id="68b6c-115">**????????**</span><span class="sxs-lookup"><span data-stu-id="68b6c-115">**Products**</span></span>|<span data-ttu-id="68b6c-116">**?????????**</span><span class="sxs-lookup"><span data-stu-id="68b6c-116">**Platforms**</span></span>|
|:-----------|:------------|
|<ul><li><span data-ttu-id="68b6c-117"> Word</span><span class="sxs-lookup"><span data-stu-id="68b6c-117">Word</span></span></li><li><span data-ttu-id="68b6c-118">Excel</span><span class="sxs-lookup"><span data-stu-id="68b6c-118">Excel</span></span></li><li><span data-ttu-id="68b6c-119">PowerPoint</span><span class="sxs-lookup"><span data-stu-id="68b6c-119">PowerPoint</span></span></li></ul>|<span data-ttu-id="68b6c-120">?????????????? ????????? ??? ???? ?????????:</span><span class="sxs-lookup"><span data-stu-id="68b6c-120">Supported platforms for all products:</span></span><ul><li><span data-ttu-id="68b6c-p104">Office ??? Windows Desktop (?????? 16.0.8121.1000 ??? ????? ???????)</span><span class="sxs-lookup"><span data-stu-id="68b6c-p104">Office for Windows Desktop. Build 16.0.8121.1000+</span></span></li><li><span data-ttu-id="68b6c-p105">Office ??? Mac (?????? 15.34.17051500 ??? ????? ???????)</span><span class="sxs-lookup"><span data-stu-id="68b6c-p105">Office for Mac. Build 15.34.17051500+</span></span></li><li><span data-ttu-id="68b6c-125">Office Online</span><span class="sxs-lookup"><span data-stu-id="68b6c-125">Office Online</span></span></li></ul>|


## <a name="best-practices"></a><span data-ttu-id="68b6c-126">?????? ? ????????????</span><span class="sxs-lookup"><span data-stu-id="68b6c-126">Best practices</span></span>

<span data-ttu-id="68b6c-127">??? ????????????? ??????? ??????????????? ???????? ??????????????? ????????? ????????????.</span><span class="sxs-lookup"><span data-stu-id="68b6c-127">Apply the following best practices when you use the autoopen feature:</span></span>

- <span data-ttu-id="68b6c-128">??????????? ??????? ??????????????? ????????, ???? ??? ??????? ????????????? ?????? ????????????? ? ???????? ???????:</span><span class="sxs-lookup"><span data-stu-id="68b6c-128">Use the autoopen feature when it will help make your add-in users more efficient, such as:</span></span>
    - <span data-ttu-id="68b6c-p106">???? ?????????? ????????? ??? ?????????? ?????? ?????????. ????????, ??? ??????????? ???????, ?????????? ????????? ???????, ??????? ???????????? ??????????? ? ??????? ??????????. ?????????? ?????? ??????????? ????????????? ?????? ? ??????????? ????????, ????? ???????? ???????????? ???????????.</span><span class="sxs-lookup"><span data-stu-id="68b6c-p106">When the document needs the add-in in order to function properly. For example, a spreadsheet that includes stock values that are periodically refreshed by an add-in. The add-in should open automatically when the spreadsheet is opened to keep the values up to date.</span></span> 
    - <span data-ttu-id="68b6c-p107">???? ???????????? ? ??????? ???????????? ?????? ????? ???????????? ??? ?????????? ??? ?????? ? ???????????? ??????????. ??????: ??????????, ??????? ???????? ????????????? ????????? ?????? ? ????????? ??? ??????? ?????????, ???????? ?????????? ?? ????????? ???????.</span><span class="sxs-lookup"><span data-stu-id="68b6c-p107">When the user will most likely always use the add-in with a particular document. For example, an add-in that helps users fill in or change data in a document by pulling information from a backend system.</span></span> 
- <span data-ttu-id="68b6c-p108">????????? ????????????? ???????? ? ????????? ??????? ??????????????? ????????. ???????? ???????? ? ????????? ??? ?????????????, ????? ?????????????? ???????? ??????? ????? ?????????? ????? ???? ?????????.</span><span class="sxs-lookup"><span data-stu-id="68b6c-p108">Allow users to turn on or turn off the autoopen feature. Include an option in your UI for users to choose to no longer automatically open the add-in task pane.</span></span>  
- <span data-ttu-id="68b6c-136">??????????? ???????? ??????????? ?????? ??????????, ????? ?????????? ??????????? ??????? ??????????????? ????????, ? ???????????? ????????? ?????? ??? ?? ??????????.</span><span class="sxs-lookup"><span data-stu-id="68b6c-136">Use requirement set detection to determine whether the autoopen feature is available, and provide a fallback behavior if it isn?t.</span></span>
- <span data-ttu-id="68b6c-p109">?? ??????????? ??????? ??????????????? ????????, ????? ???????????? ??????????? ?????????? ????????????? ??????????. ???? ?????????????? ???????? ?????????? ??????????????? ??? ???????????? ??????????, ??? ??????? ????? ?????????? ?????????????.</span><span class="sxs-lookup"><span data-stu-id="68b6c-p109">Don't use the autoopen feature to artificially increase usage of your add-in. If it doesn?t make sense for your add-in to open automatically with certain documents, this feature can annoy users.</span></span> 

    > [!NOTE]
    > <span data-ttu-id="68b6c-139">???? ?????????? ?????????? ?????????, ??? ??????? ??????????????? ???????? ??????????? ?? ?? ??????????, ???????? ?????????? ????? ?????????? ?? AppSource.</span><span class="sxs-lookup"><span data-stu-id="68b6c-139">If Microsoft detects abuse of the autoopen feature, your add-in might be rejected from AppSource.</span></span> 

- <span data-ttu-id="68b6c-p110">?? ??????????? ??? ???????, ????? ????????? ????????? ???????? ?????. ????? ?????? ?????? ???? ??????? ????? ?????????? ??? ??????????????? ???????? ?????? ? ??????????.</span><span class="sxs-lookup"><span data-stu-id="68b6c-p110">Don't use this feature to pin multiple task panes. You can only set one pane of your add-in to open automatically with a document.</span></span>  

## <a name="implementation"></a><span data-ttu-id="68b6c-142">??????????</span><span class="sxs-lookup"><span data-stu-id="68b6c-142">Implementation</span></span>
<span data-ttu-id="68b6c-143">????????? ????????? ????????, ????? ???????????? ??????? ??????????????? ????????.</span><span class="sxs-lookup"><span data-stu-id="68b6c-143">To implement the autoopen feature:</span></span>

- <span data-ttu-id="68b6c-144">??????? ??????? ?????, ??????? ?????????? ????????? ?????????????.</span><span class="sxs-lookup"><span data-stu-id="68b6c-144">Specify the task pane to be opened automatically.</span></span>
- <span data-ttu-id="68b6c-145">???????? ????????, ? ??????? ????? ????????????? ??????????? ??? ??????? ?????.</span><span class="sxs-lookup"><span data-stu-id="68b6c-145">Tag the document to automatically open the task pane.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="68b6c-p111">???????, ?????????? ??? ??????????????? ????????, ????? ???????????, ?????? ???? ??????????? ?????????? ??? ???? ?? ?????????? ????????????. ???? ??? ??? ?? ???????????, ??????? ??????????????? ???????? ?? ????????? ??? ???????? ?????????, ? ???????? ????? ??????????????. ????? ?????????? ???????????????? ?????? ? ??????????, ??????? ??? ???????? visibility ???????? 1. ??? ????? ??????? ?????? ? ??????? OpenXML. ??????????????? ?????? ???????? ????.</span><span class="sxs-lookup"><span data-stu-id="68b6c-p111">The pane that you designate to open automatically will only open if the add-in is already installed on the user's device. If the user does not have the add-in installed when they open a document, the autoopen feature will not work and the setting will be ignored. If you also require the add-in to be distributed with the document you need to set the visibility property to 1; this can only be done using OpenXML, an example is provided later in this article.</span></span> 

### <a name="step-1-specify-the-task-pane-to-open"></a><span data-ttu-id="68b6c-149">???? 1. ???????? ??????? ?????, ??????? ?????????? ?????????</span><span class="sxs-lookup"><span data-stu-id="68b6c-149">Step 1: Specify the task pane to open</span></span>
<span data-ttu-id="68b6c-p112">????? ??????? ??????? ?????, ??????? ?????????? ????????? ?????????????, ??????? ??? [TaskpaneId](https://dev.office.com/reference/add-ins/manifest/action#taskpaneid) ???????? **Office.AutoShowTaskpaneWithDocument**. ??? ???????? ????? ?????????? ?????? ? ????? ??????? ?????. ???? ?????????? ??? ???????? ??? ?????????? ???????? ?????, ???????????? ?????? ?????? ?????? ??? ?????????????, ? ??? ????????? ????? ??????????????.</span><span class="sxs-lookup"><span data-stu-id="68b6c-p112">To specify the task pane to open automatically, set the [TaskpaneId](https://dev.office.com/reference/add-ins/manifest/action#taskpaneid) value to **Office.AutoShowTaskpaneWithDocument**. You can only set this value on one task pane. If you set this value on multiple task panes, the first occurrence of the value will be recognized and the others will be ignored.</span></span> 

<span data-ttu-id="68b6c-153">???? ??????????? ??????, ??? ??? TaskPaneId ?????? ???????? Office.AutoShowTaskpaneWithDocument.</span><span class="sxs-lookup"><span data-stu-id="68b6c-153">The following example shows the TaskPaneId value set to Office.AutoShowTaskpaneWithDocument.</span></span>
          
```xml
<Action xsi:type="ShowTaskpane">
    <TaskpaneId>Office.AutoShowTaskpaneWithDocument</TaskpaneId>
    <SourceLocation resid="Contoso.Taskpane.Url" />
</Action>
```     

### <a name="step-2-tag-the-document-to-automatically-open-the-task-pane"></a><span data-ttu-id="68b6c-154">???? 2. ????????? ??????? ??? ?????????, ?????? ? ??????? ????? ????????????? ??????????? ??????? ?????</span><span class="sxs-lookup"><span data-stu-id="68b6c-154">Step 2: Tag the document to automatically open the task pane</span></span>

<span data-ttu-id="68b6c-155">?? ?????? ???????? ???????? ??? ??????? ??????? ??????????????? ???????? ????? ?? ???? ????????.</span><span class="sxs-lookup"><span data-stu-id="68b6c-155">You can tag the document to trigger the autoopen feature in one of two ways.</span></span> <span data-ttu-id="68b6c-156">???????? ???????, ??????? ????? ????? ???????? ??? ?????? ????????.</span><span class="sxs-lookup"><span data-stu-id="68b6c-156">Pick the alternative that works best for your scenario.</span></span>  


#### <a name="tag-the-document-on-the-client-side"></a><span data-ttu-id="68b6c-157">????????? ??????? ??? ????????? ?? ??????? ???????</span><span class="sxs-lookup"><span data-stu-id="68b6c-157">Tag the document on the client side</span></span>
<span data-ttu-id="68b6c-158">??????????? ????? Office.js [settings.set](https://dev.office.com/reference/add-ins/shared/settings.set), ????? ?????????? ??? **Office.AutoShowTaskpaneWithDocument** ???????? **true**, ??? ???????? ? ????????? ???????.</span><span class="sxs-lookup"><span data-stu-id="68b6c-158">Use the Office.js [settings.set](https://dev.office.com/reference/add-ins/shared/settings.set) method to set **Office.AutoShowTaskpaneWithDocument** to **true**, as shown in the following example.</span></span>   

```js
Office.context.document.settings.set("Office.AutoShowTaskpaneWithDocument", true);
Office.context.document.settings.saveAsync();
```

<span data-ttu-id="68b6c-159">??????????? ???? ?????, ???? ????? ???????? ???????? ? ?????? ?????????????? ? ??????????? (????????, ????? ???????? ????????????? ???????? ??? ?????? ?????????, ?? ?????? ??????? ????????????? ? ?????????????? ???????? ???????).</span><span class="sxs-lookup"><span data-stu-id="68b6c-159">Use this method if you need to tag the document as part of your add-in interaction (for example, as soon as the user creates a binding, or chooses an option to indicate that they want the pane to open automatically).</span></span>

#### <a name="use-open-xml-to-tag-the-document"></a><span data-ttu-id="68b6c-160">????????? ??????? ??? ????????? ? ??????? Open XML</span><span class="sxs-lookup"><span data-stu-id="68b6c-160">Use Open XML to tag the document</span></span>
<span data-ttu-id="68b6c-p114">? ??????? Open XML ????? ??????? ???????? ? ??????? ? ???? ?????????, ? ????? ????????? ??????????????? ??????????? ? Open Office XML ??? ??????? ??????? ??????????????? ????????. ?????? ? ???????????? ????, ??? ??? ????? ???????, ??. ? ?????? [Office-OOXML-EmbedAddin](https://github.com/OfficeDev/Office-OOXML-EmbedAddin).</span><span class="sxs-lookup"><span data-stu-id="68b6c-p114">You can use Open XML to create or modify a document and add the appropriate Open Office XML markup to trigger the autoopen feature. For a sample that shows you how to do this, see [Office-OOXML-EmbedAddin](https://github.com/OfficeDev/Office-OOXML-EmbedAddin).</span></span> 

<span data-ttu-id="68b6c-163">???????? ? ???????? ??? ????? Open XML:</span><span class="sxs-lookup"><span data-stu-id="68b6c-163">Add two Open XML parts to the document:</span></span>

- <span data-ttu-id="68b6c-164">????? webextension;</span><span class="sxs-lookup"><span data-stu-id="68b6c-164">A webextension part</span></span>
- <span data-ttu-id="68b6c-165">????? taskpane.</span><span class="sxs-lookup"><span data-stu-id="68b6c-165">A task pane part</span></span>

<span data-ttu-id="68b6c-166">? ????????? ??????? ????????, ??? ???????? ????? webextension.</span><span class="sxs-lookup"><span data-stu-id="68b6c-166">The following example shows how to add the webextension part.</span></span>

```xml
<we:webextension xmlns:we="http://schemas.microsoft.com/office/webextensions/webextension/2010/11" id="[ADD-IN ID PER MANIFEST]">
  <we:reference id="[GUID or AppSource asset ID]" version="[your add-in version]" store="[Pointer to store or catalog]" storeType="[Store or catalog type]"/>
  <we:alternateReferences/>
  <we:properties>
    <we:property name="Office.AutoShowTaskpaneWithDocument" value="true"/>
  </we:properties>
  <we:bindings/>
  <we:snapshot xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"/>
</we:webextension>
```

<span data-ttu-id="68b6c-167">????? webextension ???????? ????????? ???????, ? ????? ???????? ??? ????????? **Office.AutoShowTaskpaneWithDocument**, ??? ???????? ?????????? ?????????? ???????? `true`.</span><span class="sxs-lookup"><span data-stu-id="68b6c-167">The webextension part includes a property bag and a property named **Office.AutoShowTaskpaneWithDocument** that must be set to `true`.</span></span>

<span data-ttu-id="68b6c-p115">????? webextension ????? ???????? ?????? ?? ??????? ??? ??????? ? ?????????? ??? `id`, `storeType`, `store`, ? `version`. ?????? 4 ???????? `storeType` ????????? ? ??????? ??????????????? ????????. ???????? ??? ????????? ???? ????????? ??????? ?? ???????? ??? `storeType`, ??? ???????? ? ??????? ????.</span><span class="sxs-lookup"><span data-stu-id="68b6c-p115">The webextension part also includes a reference to the store or catalog with attributes for `id`, `storeType`, `store`, and `version`. Of the `storeType` values, only four are relevant to the autoopen feature. The values for the other three attributes depend on the value for `storeType`, as shown in the following table.</span></span> 

| <span data-ttu-id="68b6c-171">**`storeType` ????????**</span><span class="sxs-lookup"><span data-stu-id="68b6c-171">**`storeType` value**</span></span> | <span data-ttu-id="68b6c-172">**`id` ????????**</span><span class="sxs-lookup"><span data-stu-id="68b6c-172">**`id` value**</span></span>    |<span data-ttu-id="68b6c-173">**`store` ????????**</span><span class="sxs-lookup"><span data-stu-id="68b6c-173">**`store` value**</span></span> | <span data-ttu-id="68b6c-174">**`version` ????????**</span><span class="sxs-lookup"><span data-stu-id="68b6c-174">**`version` value**</span></span>|
|:---------------|:---------------|:---------------|:---------------|
|<span data-ttu-id="68b6c-175">OMEX (AppSource)</span><span class="sxs-lookup"><span data-stu-id="68b6c-175">OMEX (AppSource)</span></span>|<span data-ttu-id="68b6c-176">?? ??????? AppSource ??? ?????????? (??. ??????????)</span><span class="sxs-lookup"><span data-stu-id="68b6c-176">The AppSource asset ID of the add-in (see Note)</span></span>|<span data-ttu-id="68b6c-177">??? ????? ??? AppSource (????????, "ru-ru").</span><span class="sxs-lookup"><span data-stu-id="68b6c-177">The locale of AppSource; for example, "en-us".</span></span>|<span data-ttu-id="68b6c-178">?????? ???????? AppSource (??. ??????????)</span><span class="sxs-lookup"><span data-stu-id="68b6c-178">The version in the AppSource catalog (see Note)</span></span>|
|<span data-ttu-id="68b6c-179">FileSystem (??????? ?????)</span><span class="sxs-lookup"><span data-stu-id="68b6c-179">FileSystem (a network share)</span></span>|<span data-ttu-id="68b6c-180">GUID ?????????? ? ?? ?????????.</span><span class="sxs-lookup"><span data-stu-id="68b6c-180">The GUID of the add-in in the add-in manifest.</span></span>|<span data-ttu-id="68b6c-181">???? ? ??????? ????? (????????, "\\\\MyComputer\\MySharedFolder").</span><span class="sxs-lookup"><span data-stu-id="68b6c-181">The path of the network share; for example, "\\\\MyComputer\\MySharedFolder".</span></span>|<span data-ttu-id="68b6c-182">?????? ? ????????? ??????????.</span><span class="sxs-lookup"><span data-stu-id="68b6c-182">The version in the add-in manifest.</span></span>|
|<span data-ttu-id="68b6c-183">EXCatalog (????????????? ????? Exchange Server)</span><span class="sxs-lookup"><span data-stu-id="68b6c-183">EXCatalog (deployment via the Exchange server)</span></span> |<span data-ttu-id="68b6c-184">GUID ?????????? ? ?? ?????????.</span><span class="sxs-lookup"><span data-stu-id="68b6c-184">The GUID of the add-in in the add-in manifest.</span></span>|<span data-ttu-id="68b6c-185">"EXCatalog".</span><span class="sxs-lookup"><span data-stu-id="68b6c-185">"EXCatalog"</span></span> <span data-ttu-id="68b6c-186">?????? EXCatalog - ??? ??????, ??????? ????? ?????????????? ? ????????????, ????????????? ???????????????? ????????????? ? ???????????????? ?????? Office 365.</span><span class="sxs-lookup"><span data-stu-id="68b6c-186">EXCatalog row is the row to use with add-ins that use Centralized Deployment in the Office 365 admin center.</span></span>|<span data-ttu-id="68b6c-187">?????? ? ????????? ??????????.</span><span class="sxs-lookup"><span data-stu-id="68b6c-187">The version in the add-in manifest.</span></span>
|<span data-ttu-id="68b6c-188">Registry (?????? ???????)</span><span class="sxs-lookup"><span data-stu-id="68b6c-188">Registry (System registry)</span></span>|<span data-ttu-id="68b6c-189">GUID ?????????? ? ?? ?????????.</span><span class="sxs-lookup"><span data-stu-id="68b6c-189">The GUID of the add-in in the add-in manifest.</span></span>|<span data-ttu-id="68b6c-190">"???????????"</span><span class="sxs-lookup"><span data-stu-id="68b6c-190">"developer"</span></span>|<span data-ttu-id="68b6c-191">?????? ? ????????? ??????????.</span><span class="sxs-lookup"><span data-stu-id="68b6c-191">The version in the add-in manifest.</span></span>|

> [!NOTE]
> <span data-ttu-id="68b6c-p117">??? ?????? ?? ??????? ? ?????? ?????????? ? AppSource ????????? ?? ??????? ???????? AppSource ??? ??????????????? ??????????. ?? ??????? ???????????? ? ???????? ?????? ????????. ?????? ??????? ? ??????? **????????** ?? ???? ????????.</span><span class="sxs-lookup"><span data-stu-id="68b6c-p117">To find the asset ID and version of an add-in in AppSource, go to the AppSource landing page for the add-in. The asset ID appears in the address bar in the browser. The version is listed in the **Details** section of the page.</span></span>

<span data-ttu-id="68b6c-195">?????????????? ???????? ?? ??????????? webextension ??. ? ????????? [[MS-OWEXML] 2.2.5. WebExtensionReference](https://msdn.microsoft.com/en-us/library/hh695383(v=office.12).aspx).</span><span class="sxs-lookup"><span data-stu-id="68b6c-195">For more information about the webextension markup, see [[MS-OWEXML] 2.2.5. WebExtensionReference](https://msdn.microsoft.com/en-us/library/hh695383(v=office.12).aspx).</span></span>

<span data-ttu-id="68b6c-196">? ????????? ??????? ????????, ??? ???????? ????? taskpane.</span><span class="sxs-lookup"><span data-stu-id="68b6c-196">The following example shows how to add the taskpane part.</span></span>

```xml
<wetp:taskpane dockstate="right" visibility="0" width="350" row="4" xmlns:wetp="http://schemas.microsoft.com/office/webextensions/taskpanes/2010/11">
  <wetp:webextensionref xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" r:id="rId1" />
</wetp:taskpane>
```

<span data-ttu-id="68b6c-p118">???????? ????????, ??? ? ???? ??????? ??? ???????? `visibility` ??????????? ???????? "0". ??? ????????, ??? ????? ?????????? ?????? webextension ? taskpane ??? ?????? ???????? ????????? ???????????? ?????????? ????? ?????????? ??????????, ????? ?????? **??????????** ?? ?????. ????? ????? ??????? ????? ?????????? ????? ??????????? ????????????? ?????? ? ??????. ????? ????, ???? ?????????? ??? `visibility` ???????? "0", ????? ? ??????? Office.js ???????????? ????????????? ??????????? ???????? ? ????????? ??????? ??????????????? ????????. ? ?????????, ??? ?????? ????????????? ??? ????????? ????????? **Office.AutoShowTaskpaneWithDocument** ???????? `true` ??? `false`. (?????????????? ???????? ??. ? ??????? [????????? ??????? ??? ????????? ?? ??????? ???????](#tag-the-document-on-the-client-side).)</span><span class="sxs-lookup"><span data-stu-id="68b6c-p118">Note that in this example, the `visibility` attribute is set to "0". This means that after the webextension and taskpane parts are added, the first time the document is opened, the user has to install the add-in from the **Add-in** button on the ribbon. Thereafter, the add-in task pane opens automatically when the file is opened. Also, when you set `visibility` to "0", you can use Office.js to enable users to turn on or turn off the autoopen feature. Specifically, your script sets the **Office.AutoShowTaskpaneWithDocument** document setting to `true` or `false`. (For details, see [Tag the document on the client side](#tag-the-document-on-the-client-side).)</span></span> 

<span data-ttu-id="68b6c-p119">???? ??? `visibility` ??????????? ???????? "1", ??????? ????? ????????? ????????????? ??? ?????? ???????? ?????????. ???????????? ????? ?????????? ???????? ??????????. ? ?????? ?????????????? ??????? ?????????? ?????????. ????? ????? ??????? ????? ?????????? ????? ??????????? ????????????? ?????? ? ??????. ?????? ???? ?????????? ??? `visibility` ???????? "1", ????? ? ??????? Office.js ???????????? ????????????? ??????????? ???????? ? ????????? ??????? ??????????????? ????????.</span><span class="sxs-lookup"><span data-stu-id="68b6c-p119">If `visibility` is set to "1", the task pane opens automatically the first time the document is opened. The user is prompted to trust the add-in, and when trust is granted, the add-in opens. Thereafter, the add-in task pane opens automatically when the file is opened. However, when `visibility` is set to "1", you can't use Office.js to enable users to turn on or turn off the autoopen feature.</span></span> 

<span data-ttu-id="68b6c-207">???????? "1" ??????? ???????? ??? ???????? `visibility`, ???? ?????????? ? ?????? ??? ?????????? ????????? ????????????? ????????? ?????, ??? ???????????? ?? ????????? ?? ????????????? ??????? ??????????????? ????????.</span><span class="sxs-lookup"><span data-stu-id="68b6c-207">Setting `visibility` to "1" is a good choice when the add-in and the template or content of the document are so closely integrated that the user would not opt out of the autoopen feature.</span></span> 

> [!NOTE]
> <span data-ttu-id="68b6c-p120">???? ?? ?????? ?????????????? ?????????? ?????? ? ??????????, ????? ????????????? ???????????? ?????????? ??, ?????????? ?????? ??? ???????? visibility ???????? 1. ??? ????? ??????? ?????? ????? Open XML.</span><span class="sxs-lookup"><span data-stu-id="68b6c-p120">If you want to distribute your add-in with the document, so that users are prompted to install it, you must set the visibility property to 1. You can only do this via Open XML.</span></span>

<span data-ttu-id="68b6c-p121">????? ??????? ?????? ?????? XML ? ??????? ????????? ?????????? ? [???????? ???????? ?? ??????? ???????](#tag-the-document-on-the-client-side), ????? ???????? ????????, ? ????? ????????? ???????? ? ????????? ????????? XML. Office ????????? ? ?????? ??????????????? ???????? ????????. ?????????? [Open XML SDK 2.5 Productivity Tool](https://www.microsoft.com/en-us/download/details.aspx?id=30425) ????? ????? ???????????? ??? ???????? ???? ?? ????? C#, ????? ??????????? ???????? ???????? ??????????? ?? ?????? ???????????? XML.</span><span class="sxs-lookup"><span data-stu-id="68b6c-p121">An easy way to write the XML is to first run your add-in and [tag the document on the client side](#tag-the-document-on-the-client-side) to write the value, and then save the document and inspect the XML that is generated. Office will detect and provide the appropriate attribute values. You can also use the [Open XML SDK 2.5 Productivity Tool](https://www.microsoft.com/en-us/download/details.aspx?id=30425) tool to generate C# code to programmatically add the markup based on the XML you generate.</span></span>

## <a name="test-and-verify-opening-taskpanes"></a><span data-ttu-id="68b6c-213">???????????? ? ???????? ????????????? ??????? ?????</span><span class="sxs-lookup"><span data-stu-id="68b6c-213">Test and verify opening taskpanes</span></span>
<span data-ttu-id="68b6c-214">?? ?????? ?????????? ???????? ?????? ????? ??????????, ???????? ????????????? ??????? ?????? ????? ? ??????? ????????????????? ????????????? ????? ??????????????? ????? Office 365.</span><span class="sxs-lookup"><span data-stu-id="68b6c-214">You can deploy a test version of your add-in thaqt will automatically open a taskpane using Centralized Deployment via the Office 365 admin center.</span></span> <span data-ttu-id="68b6c-215">? ????????? ??????? ????????, ??? ??????????? ?????????? ?? ???????? ????????????????? ????????????? ? ?????????????? ?????? ????????? EXCatalog.</span><span class="sxs-lookup"><span data-stu-id="68b6c-215">The following example shows how add-ins are inserted from the Centralized Deployment catalog using the EXCatalog store version.</span></span>

```xml
<we:webextension xmlns:we="http://schemas.microsoft.com/office/webextensions/webextension/2010/11" id="{52811C31-4593-43B8-A697-EB873422D156}">
    <we:reference id="af8fa5ba-4010-4bcc-9e03-a91ddadf6dd3" version="1.0.0.0" store="EXCatalog" storeType="EXCatalog"/>
    <we:alternateReferences/>
    <we:properties/>
    <we:bindings/>
    <we:snapshot xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"/>
</we:webextension>
```
<span data-ttu-id="68b6c-216">????? ????????? ?????????? ??????, ??.?????? [????????? ????? ?????????? Office 365](https://msdn.microsoft.com/en-us/office/office365/howto/setup-development-environment) ? ?????????????????????? ?????????? [??????? ?????? ???????????? Office 365](https://developer.microsoft.com/en-us/office/dev-program).</span><span class="sxs-lookup"><span data-stu-id="68b6c-216">To test the previous example, please see [Setup your Office 365 development environment](https://msdn.microsoft.com/en-us/office/office365/howto/setup-development-environment) and consider signing up for an [Office 365 developer account](https://developer.microsoft.com/en-us/office/dev-program).</span></span> <span data-ttu-id="68b6c-217">?????????? ?? ?????? ?????????? ???????? ?????? ????????????????? ????????????? ? ?????????, ??? ???? ?????????? ???????? ?????????.</span><span class="sxs-lookup"><span data-stu-id="68b6c-217">You can actually test drive Centralized Deployment and verify that your add-in works as expected.</span></span>


## <a name="see-also"></a><span data-ttu-id="68b6c-218">??. ?????</span><span class="sxs-lookup"><span data-stu-id="68b6c-218">See also</span></span>

<span data-ttu-id="68b6c-219">?????? ????????????? ??????? ??????????????? ???????? ??. ? ?????? [??????? ?????? ??? ?????????? Office](https://github.com/OfficeDev/Office-Add-in-Commands-Samples/tree/master/AutoOpenTaskpane).</span><span class="sxs-lookup"><span data-stu-id="68b6c-219">For a sample that shows you how to use the autoopen feature, see [Office Add-in commands samples](https://github.com/OfficeDev/Office-Add-in-Commands-Samples/tree/master/AutoOpenTaskpane).</span></span> 
<span data-ttu-id="68b6c-220">[??????????????? ? ????????? ???????????? Office 365](https://docs.microsoft.com/en-us/office/developer-program/office-365-developer-program).</span><span class="sxs-lookup"><span data-stu-id="68b6c-220">[Join the Office 365 developer program](https://docs.microsoft.com/en-us/office/developer-program/office-365-developer-program).</span></span> 


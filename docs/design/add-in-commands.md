
# <a name="add-in-commands-for-excel-word-and-powerpoint"></a>Команды надстроек для Excel, Word и PowerPoint

Команды надстроек — это элементы, которые расширяют пользовательский интерфейс Office и запускают действия в надстройке. Команды надстроек можно использовать для добавления кнопки на ленту или элемента в контекстное меню. Когда пользователи выбирают команду надстройки, они инициируют действия, такие как запуск кода JavaScript или отображение страницы надстройки в области задач. Команды надстройки помогают пользователям находить и использовать вашу надстройку, что может повысить показатель внедрения надстройки и коэффициент удержания клиентов.

Обзор этой функции приведен в видео, посвященном [командам надстроек на ленте Office](https://channel9.msdn.com/events/Build/2016/P551).

>**Примечание.** В каталогах SharePoint команды надстроек не поддерживаются. Развернуть их можно с помощью [централизованного развертывания](../publish/centralized-deployment.md) или [Магазина Office](https://dev.office.com/officestore/docs/submit-to-the-office-store). Чтобы развернуть команду надстройки для тестирования, используйте [загрузку неопубликованного приложения](../testing/create-a-network-shared-folder-catalog-for-task-pane-and-content-add-ins). 

**Надстройка с командами, работающая в классическом приложении Excel**

![Снимок экрана с командой надстройки в приложении Excel](../../images/addincommands1.png)

**Надстройка с командами, работающая в Excel Online**

![Снимок экрана с командой надстройки в Excel Online](../../images/addincommands2.png)

## <a name="command-capabilities"></a>Возможности команд
В настоящее время поддерживаются указанные ниже возможности команд.

> **Примечание.** Контентные надстройки на данный момент не поддерживают команды.

**Точки расширения**

- Вкладки ленты: расширение возможностей встроенных вкладок или создание пользовательской вкладки.
- Контекстные меню: расширение возможностей выбранных контекстных меню. 

**Типы элементов управления**

- Простые кнопки, запускающие определенные действия.
- Простые раскрывающиеся меню с кнопками, которые запускают действия.

**Действия**

- ShowTaskpane: отображает одну или несколько областей, в которые можно загрузить пользовательские HTML-страницы.
- ExecuteFunction загружает невидимую HTML-страницу, а затем выполняет содержащуюся в ней функцию JavaScript. Для показа ошибок, хода выполнения или дополнительных данных функции можно использовать API [displayDialog](http://dev.office.com/reference/add-ins/shared/officeui).  

## <a name="supported-platforms"></a>Поддерживаемые платформы
В настоящее время команды надстроек поддерживаются на следующих платформах:

- Office 2016 для Windows Desktop (сборки 16.0.6769 или более поздней);
- Office для Mac (сборки 15.33 или более поздней);
- Office Online. 

Скоро можно будет использовать другие платформы.

## <a name="best-practices"></a>Рекомендации

При разработке надстроек придерживайтесь следующих рекомендаций:

- Каждая команда должна представлять определенное действие с очевидным и конкретным исходом для пользователей. Не совмещайте несколько действий в одной кнопке.
- Предоставляйте точные действия, которые делают выполнение распространенных задач в надстройке более эффективным. Максимально сократите количество шагов, необходимых для выполнения действия.
- Расположение команд на ленте Office:
    - Помещайте команды на имеющиеся вкладки ("Вставка", "Рецензирование" и т. д.), если соответствующая функция подходит для них. Например, если надстройка позволяет вставлять файлы мультимедиа, добавьте группу на вкладку "Вставка". Обратите внимание, что некоторые вкладки доступны не во всех версиях Office. Дополнительные сведения см. в статье [XML-манифест надстроек Office](../overview/add-in-manifests.md). 
    - Добавляйте команды на вкладку "Главная", если соответствующие функции не относятся к другим вкладкам и надстройка содержит менее шести команд верхнего уровня. Вы также можете добавлять команды на вкладку "Главная", если надстройка должна работать в разных версиях Office (например, классических приложениях Office и Office Online), а нужная вкладка доступна не во всех версиях (например, вкладка "Конструктор" отсутствует в Office Online).  
    - Добавляйте команды на пользовательскую вкладку, если надстройка содержит более шести команд верхнего уровня. 
    - Название группы должно соответствовать названию надстройки. Если у вас есть несколько групп, их имена должны быть связаны с функциями, которые выполняют команды из этих групп.
    - Не добавляйте лишних кнопок, чтобы надстройка занимала больше места.

     >**Примечание.**  Надстройки, которые занимают слишком много места, могут не пройти [проверку в Магазине Office](https://dev.office.com/officestore/docs/validation-policies).

- [Руководство по созданию значков](../design/design-icons.md) подходит для всех значков.
- Предоставьте версию надстройки, которая работает в ведущих приложениях, не поддерживающих команды. Один манифест надстройки может работать в ведущих приложениях независимо от того, поддерживают ли они команды.

    ![Снимок экрана: надстройка области задач в Office 2013 и эта же надстройка, использующая команды надстройки в Office 2016](../../images/4f90a3cc-8cc4-4879-9a03-0bb2b6079026.png)


## <a name="next-steps-to-get-started"></a>Следующие действия

Лучший способ начать работу с командами надстроек — ознакомиться с [примерами](https://github.com/OfficeDev/Office-Add-in-Commands-Samples/) на сайте GitHub.

Дополнительные сведения об указании команд надстройки в манифесте см. в статье [Определение команд надстроек в манифесте](../develop/define-add-in-commands.md) и справочных материалах по [VersionOverrides](../../reference/manifest/versionoverrides.md).






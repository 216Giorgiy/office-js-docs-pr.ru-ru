---
title: ??????? ???????, ????????? ? API JavaScript ??? Excel
description: ''
ms.date: 1/18/2018
ms.openlocfilehash: 89db69e124475c882448a2105837787ce2c84753
ms.sourcegitcommit: c72c35e8389c47a795afbac1b2bcf98c8e216d82
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/23/2018
---
# <a name="excel-javascript-api-advanced-concepts"></a>??????? ???????, ????????? ? API JavaScript ??? Excel

??? ?????? ???????? ???????????? ?????? [???????? ??????? API JavaScript ??? Excel](excel-add-ins-core-concepts.md). ? ??? ??????????? ????? ??????? ???????, ??????????? ??? ???????? ??????? ????????? ??? Excel 2016. 

## <a name="officejs-apis-for-excel"></a>?????????? API Office.js ??? Excel

?????????? Excel ??????????????? ? ????????? ? Excel ? ??????? API JavaScript ??? Office, ??????????? ??? ????????? ?????? JavaScript:

* **API JavaScript ??? Excel**. ??????????? ? Office 2016 [API JavaScript ??? Excel](https://dev.office.com/reference/add-ins/excel/excel-add-ins-reference-overview) ????????????? ?????? ?????????????? ???????, ? ??????? ??????? ????? ???????? ?????? ? ??????, ??????????, ????????, ?????????? ? ?????? ????????. 

* **????? API**. ??????????? ? Office 2013 [????? API](https://dev.office.com/reference/add-ins/javascript-api-for-office) ????? ???????????? ??? ??????? ? ????? ???????????, ??? ???????????????? ?????????, ?????????? ???? ? ????????? ????????, ????? ??? ?????????? ????? ??????? ??????????, ???????? Word, Excel ? PowerPoint.

?????? ?????, ? ?????????? ??????????? ??????? ????????? ??? Excel 2016 ?? ?????? ???????????? API JavaScript ??? Excel, ?? ??????? ? API Shared ???? ????? ?????. ????????:

- [Context](https://dev.office.com/reference/add-ins/shared/context). ?????? **Context** ???????????? ????? ?????????? ?????????? ? ????????????? ?????? ? ???????? ???????? API. ?? ??????? ?? ?????? ???????????? ?????, ???????? `contentLanguage` ? `officeTheme`, ? ????? ????????????? ???????? ? ????? ?????????? ??????????, ???????? `host` ? `platform`. ????? ????, ?? ????????????? ????? `requirements.isSetSupported()`, ? ??????? ???????? ????? ?????????, ?????????????? ?? ????????? ????? ???????????? ????????? ??????????? Excel, ? ??????? ???????? ??????????. 

- [????????](https://dev.office.com/reference/add-ins/shared/document). ?????? **Document** ????????????? ????? `getFileAsync()`, ??????????? ??????? ???? Excel, ? ??????? ???????? ??????????. 

## <a name="requirement-sets"></a>?????? ???????????? ?????????

?????? ???????????? ????????? ? ??? ??????????? ?????? ????????? API. ?????????? Office ????? ????????? ???????? ? ????? ?????????? ??? ???????????? ????????? ? ????????? ?????? ???????????? ?????????, ????? ??????????, ???????????? ?? ??????? ?????????? Office ??????????? ?????????? API. ???????? ? ???, ????? ?????? ?????? ???????????? ????????? ???????? ?? ?????? ?????????????? ?????????, ??. ? ?????? [?????? ???????????? ????????? API JavaScript ??? Excel](https://dev.office.com/reference/add-ins/requirement-sets/excel-api-requirement-sets).

### <a name="checking-for-requirement-set-support-at-runtime"></a>???????? ????????? ??????? ???????????? ????????? ? ????? ??????????

? ??????????? ???? ??????? ???? ????????, ??? ??????????, ???????????? ?? ??????? ?????????? ?????????? ????????? ????? ???????????? ????????? API.

```js
if (Office.context.requirements.isSetSupported('ExcelApi', 1.3) === true) {
  /// perform actions
}
else {
  /// provide alternate flow/logic
}
```

### <a name="defining-requirement-set-support-in-the-manifest"></a>??????????? ????????? ??????? ???????????? ????????? ? ?????????

? ??????? [???????? Requirements](https://dev.office.com/reference/add-ins/manifest/requirements) ? ????????? ?????????? ????? ??????? ??????????? ?????? ???????????? ????????? ?/??? ?????? API, ??????????? ?????????? ??? ?????????. ???? ????????? ??? ??????? ?????????? Office ?? ???????????? ?????? ???????????? ????????? ??? ?????? API, ????????? ? ???????? **Requirements** ?????????, ?????????? ?? ????? ???????? ? ???? ??????? ?????????? ??? ?? ???? ?????????, ? ????? ?? ????? ???????????? ? ?????? ????????? ? ??????? **??? ??????????**. 

? ??????????? ???? ??????? ???? ??????? ??????? **Requirements** ? ????????? ??????????, ??? ???????, ??? ?????????? ?????? ??????????? ?? ???? ??????? ??????????? Office, ?????????????? ????? ???????????? ????????? ExcelApi ?????? 1.3 ??? ????.

```xml
<Requirements>
   <Sets DefaultMinVersion="1.3">
      <Set Name="ExcelApi" MinVersion="1.3"/>
   </Sets>
</Requirements>
```

> [!NOTE]
> ????? ?????????? ???? ???????? ?? ???? ?????????? ???????? ?????????? Office, ???????? Excel ??? Windows, Excel Online ? Excel ??? iPad, ??????????? ????????? ????????? ???????????? ????????? ? ????? ??????????, ? ?? ?????????? ????????? ?????? ???????????? ????????? ? ?????????.

### <a name="requirement-sets-for-the-officejs-common-api"></a>?????? ???????????? ????????? ?????? API JavaScript ??? Office

???????? ? ??????? ???????????? ????????? ?????? API ??? Office ??. ? [???? ??????](https://dev.office.com/reference/add-ins/requirement-sets/office-add-in-requirement-sets).

## <a name="loading-the-properties-of-an-object"></a>???????? ??????? ???????

????? ?????? `load()` ??? ??????? JavaScript ? Excel ???????? API, ??? ????????? ????????? ?????? ? ?????? JavaScript ??? ?????????? ?????? `sync()`. ????? `load()` ????????? ??????, ?????????? ??????????? ???????? ????? ???????, ??????? ????????? ?????????, ??? ??????, ??????????? ??????????? ????????, ????????? ???????? ?? ???????? ? ?. ?. 

> [!NOTE]
> ???? ??????? ????? `load()` ??? ??????? (??? ?????????), ?? ???????? ?????????, ?? ????? ????????? ??? ????????? ???????? ??????? (??? ??? ????????? ???????? ???? ???????? ? ?????????). ????? ????????? ?????????? ??????, ???????????? ????? ??????? ??????????? Excel ? ???????????, ??????? ???????? ??????? ?????? `load()` ??? ?????? ???????? ??????????? ???????.

### <a name="method-details"></a>???????? ? ??????

#### <a name="loadparam-object"></a>load(param: ??????)

????????? ??????-??????, ????????? ? ???? JavaScript, ?????????? ???????? ? ???????, ?????????? ? ??????????.

#### <a name="syntax"></a>?????????

```js
object.load(param);
```

#### <a name="parameters"></a>?????????

|**????????**|**???**|**????????**|
|:------------|:-------|:----------|
|`param`|??????|?????????????? ????????. ????????? ????? ?????????? ? ?????? ? ???? ?????? ? ?????????????-???????? ??? ???????. ????? ????, ????? ???????? ??????, ????? ?????? ???????? ????????? ? ????????? (??? ???????? ? ??????????? ???? ???????).|

#### <a name="returns"></a>???????????? ????????

????????????

#### <a name="example"></a>??????

? ??????????? ???? ??????? ???? ????????, ??? ?????? ???????? ?????? ????????? ? Excel, ?????????? ?? ?? ???????. ???????? ????????, ??? ??? ?????? ?????????? ????????? ???????? ??????, ????? ????? ???? ???????? ?????? ? ????????? ??? ??????? ? ???????? ?? ? ??????? ????????. ? ???? ??????? ??????????????, ??? ??? ????????? (**B2:E2** ? **B7:E7**) ???????? ??????, ? ?? ?????????????? ?????????? ??????????.

```js
Excel.run(function (ctx) { 
    var sheet = ctx.workbook.worksheets.getItem("Sample");
    var sourceRange = sheet.getRange("B2:E2");
    sourceRange.load("format/fill/color, format/font/name, format/font/color");

    return ctx.sync()
        .then(function () {
            var targetRange = sheet.getRange("B7:E7");
            targetRange.set(sourceRange); 
            targetRange.format.autofitColumns();

            return ctx.sync();
        });
}).catch(function(error) {
    console.log("Error: " + error);
    if (error instanceof OfficeExtension.Error) {
        console.log("Debug info: " + JSON.stringify(error.debugInfo));
    }
});
```

### <a name="load-option-properties"></a>???????? ??????? ??????????

?????? ???? ????? ?????????? ?????? ? ?????????????-???????? ??? ?????? ??? ?????? ?????? `load()`, ????? ???????? ??????, ?????????? ????????? ???? ????????. 

|**????????**|**???**|**????????**|
|:-----------|:-------|:----------|
|`select`|??????|???????? ?????? ??? ??????????? ???????? ?????? ???? ?????????? ? ??????. ?????????????? ????????.|
|`expand`|??????|???????? ?????? ??? ??????????? ???????? ?????? ???? ??????. ?????????????? ????????.|
|`top`|int| ????????? ???????????? ????? ????????? ? ?????????, ??????? ????? ???????? ? ?????????. ?????????????? ????????. ??? ????? ?????????, ?????? ???? ???????????? ???????? ??????? ????????.|
|`skip`|int|??????? ?????????? ????????? ? ?????????, ??????? ?????????? ?????????? ? ????????? ?? ??????????. ???? ?????? ???????? `top`, ?????????????? ????? ???????? ????? ???????? ????????? ????? ?????????. ??????????????. ??? ????? ?????????, ?????? ???? ???????????? ???????? ??????? ????????.|

? ??????????? ???? ??????? ???? ????????, ??? ????????? ????????? ??????, ?????? ???????? `name` ? `address` ????????????? ????????? ??? ??????? ????? ? ?????????. ? ??? ????? ???????, ??? ??????? ????????? ?????? ???? ??????? ?????? ? ?????????. ??? ????????? ????????? ???? ?????? ????? ??????? ??? ????????? ???????? `top: 10` ? `skip: 5`. 

```js 
myWorksheets.load({
    select: 'name, userRange/address',
    expand: 'tables',
    top: 5,
    skip: 0
});
```

## <a name="scalar-and-navigation-properties"></a>????????? ? ????????????? ???????? 

?? ????? ????????, ??? ? ?????????? ???????????? ?? API JavaScript ??? Excel ???????? ???????? ??????? ?? ??? ?????????: **????????** ? **?????**. ???????? ??????? ? ??? ????????? ???????, ???????? ??????, ????? ????? ??? ?????????? ????????, ? ????? ??????? (?????? ???????? ? ???????? ?????????) ? ??? ???????, ?????????????? ????? ?????? ??? ?? ?????????. ????????, ???????? `name` ? `position` ??????? [Worksheet](https://dev.office.com/reference/add-ins/excel/worksheet) ???????? ?????????? ??????????, ? `protection` ? `tables` ? ??????? (?????????? ?????????). 

### <a name="scalar-properties-and-navigation-properties-with-objectload"></a>????????? ? ????????????? ???????? ? ??????? `object.load()`

??? ?????? ?????? `object.load()` ??? ???????? ?????????? ??????????? ??? ????????? ???????? ???????. ???????? ????????? ??????? ?? ???????????. ????? ????, ???????? ????????? ?????????? ????????? ????????. ?????? ????? ??????? ???????????? ????? `load()`, ????? ????????? ?? ????????? ????????? ???????? ? ?????? ???????? ?????????. ????????, ????? ????????? ??? ?????? ??? ?????????, ?????????? ??????? ???????? ????????? **format** ? **font** ? ???????? ???? ? ???????? **name**:

```js
someRange.load("format/font/name")
```

> [!NOTE]
> ? ??????? API JavaScript ??? Excel ????? ???????? ????????? ???????? ?? ?????????????? ???????? ?? ???? ? ???. ????????, ?? ?????? ?????? ?????? ?????? ??? ????????? ? ??????? ??????? `someRange.format.font.size = 10;`. ????? ?????? ????????, ????????????? ????????? ???. 

## <a name="setting-properties-of-an-object"></a>????????? ??????? ???????

????????? ??????? ??????? ? ?????????? ?????????? ????????? ????? ???? ?????????? ???????. ?????? ???? ????? ???????? ????????? ???????? ? ??????? ????? ?????????, ??? ??????? ????, ?? ?????? ???????????? ????? `object.set()`, ????????? ??? ???? ???????? ? API JavaScript ??? Excel. ? ??????? ????? ?????? ????? ?????? ????? ????????? ??????? ???????, ????????? ?????? ?????? ???? ?? ???? Office.js ??? ?????? JavaScript ?? ??????????, ???????? ?? ????????? ?? ?????????? ???????, ??? ???????? ?????????? ?????.

> [!NOTE]
> ????? `set()` ?????????? ?????? ??? ???????? API JavaScript ??? Office ? ???????????? ??????? ???????????, ????? ??? API JavaScript ??? Excel. ????? API ?? ???????????? ???? ?????. 

### <a name="set-properties-object-options-object"></a>set (properties: ??????, options: ??????)

????????? ???????, ??? ???????? ?????????? ?????, ????????????? ?? ?? ????????, ??? ? ??????????????? ????????? ??????????? ???????. ???? ???????? `properties` ???????? ???????? JavaScript, ????? ???????? ? ?????????? ???????, ??????????????? ???????????????? ???????? ? ???????, ??? ???????? ?????????? ?????, ???? ????????????, ???? ???????? ? ????????????? ??????????, ? ??????????? ?? ???????? ????????? `options`.

#### <a name="syntax"></a>?????????

```js
object.set(properties[, options]);
```

#### <a name="parameters"></a>?????????

|**????????**|**???**|**????????**|
|:------------|:--------|:----------|
|`properties`|??????|???? ?????? ???? ?? ???? Office.js, ??? ? ??????, ??? ???????? ?????????? ?????, ???? ?????? JavaScript, ????? ? ???? ??????? ???????? ????????? ????????? ???????, ??? ???????? ?????????? ?????.|
|`options`|??????|?????????????? ????????. ????? ????????????, ?????? ???? ?????? ???????? ???????? ???????? JavaScript. ?????? ????? ????????? ????????? ????????: `throwOnReadOnly?: boolean` (?? ????????? ? `true`: ???? ?????????? ?????? JavaScript ???????? ??????????????? ????????, ????????? ??????.)|

#### <a name="returns"></a>???????????? ????????

????????????    

#### <a name="example"></a>??????

? ??????????? ???? ??????? ???? ????????, ??? ?????? ????????? ??????? ??????? ?????????, ?????? ????? `set()` ? ??????? ? ???? ?????? JavaScript, ????? ? ???? ??????? ???????? ????????? ????????? ??????? ??????? **Range**. ? ???? ??????? ??????????????, ??? ?????? ????????? ? ????????? **B2:E2**.

```js
Excel.run(function (ctx) { 
    var sheet = ctx.workbook.worksheets.getItem("Sample");
    var range = sheet.getRange("B2:E2");
    range.set({
        format: {
            fill: {
                color: '#4472C4'
            },
            font: {
                name: 'Verdana',
                color: 'white'
            }
        }
    });
    range.format.autofitColumns();

    return ctx.sync(); 
}).catch(function(error) {
    console.log("Error: " + error);
    if (error instanceof OfficeExtension.Error) {
        console.log("Debug info: " + JSON.stringify(error.debugInfo));
    }
});
```
## <a name="42ornullobject-methods"></a>?????? *OrNullObject

?????? ?????? API JavaScript ??? Excel ?????????? ??????????, ???? ??????? API ?? ???????????. ????????, ???? ??? ????????? ????? ??????? ??? ?????, ?? ???????????? ? ?????, ?? ????? `getItem()` ?????? ?????????? `ItemNotFound`. 

?????? ???? ????? ????????????? ??????? ?????? ????????? ?????????? ??? ?????? ????????, ????? ???????????? ??????? ?????? `*OrNullObject`, ????????? ??? ?????????? ??????? ? API JavaScript ??? Excel. ???? ????????? ??????? ?? ??????????, ????? `*OrNullObject` ?????????? ??????? ?????? (?? ?????? JavaScript `null`), ?????? ???? ????? ?????????? ??????????. ????????, ?? ?????? ??????? ????? `getItemOrNullObject()` ??? ?????????, ???????? **Worksheets**, ????? ??????????? ???????? ??????? ?? ?????????. ????? `getItemOrNullObject()` ?????????? ????????? ???????, ???? ?? ??????????. ? ????????? ?????? ???????????? ??????? ??????. ???????????? ??????? ?????? ???????? ?????????? ???????? `isNullObject`, ? ??????? ???????? ????? ??????????, ?????????? ?? ??????.

? ??????????? ???? ??????? ???? ?????????????? ??????? ???????? ???? Data ? ??????? ?????? `getItemOrNullObject()`. ???? ????? ?????????? ??????? ??????, ??, ?????? ??? ????????? ?????-???? ???????? ? ??????, ??? ?????????? ???????.

```js
var dataSheet = context.workbook.worksheets.getItemOrNullObject("Data"); 

return context.sync()
  .then(function() {
    if (dataSheet.isNullObject) { 
        // Create the sheet
    }

    dataSheet.position = 1;
    //...
  })
```

## <a name="see-also"></a>??. ?????
 
* [???????? ??????? API JavaScript ??? Excel](excel-add-ins-core-concepts.md)
* [??????? ???? ????????? Excel](http://dev.office.com/code-samples#?filters=excel,office%20add-ins)
* [??????????? ?????????????????? JavaScript API ??? Excel](https://dev.office.com/reference/add-ins/excel/performance.md)
* [?????? ?? API JavaScript ??? Excel](https://dev.office.com/reference/add-ins/excel/excel-add-ins-reference-overview)

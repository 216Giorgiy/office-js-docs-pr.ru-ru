---
title: ??????????? ?????????????????? API JavaScript ??? Excel
description: ??????????? ?????????????????? ? ??????? API Excel JavaScript
ms.date: 03/28/2018
ms.openlocfilehash: dabbb69f8dee0df782a265edcfdfb1c89894e915
ms.sourcegitcommit: c72c35e8389c47a795afbac1b2bcf98c8e216d82
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/23/2018
---
# <a name="performance-optimization-using-the-excel-javascript-api"></a>??????????? ?????????????????? ? ?????????????? API Excel JavaScript

?????????? ????????? ???????? ?????????? ????? ????? ? ??????? API Excel JavaScript. ?? ??????? ???????????? ???????? ? ?????????????????? ????? ?????????? ?????????. ? ???? ?????? ????????? ??????? ?????????? ? ????, ????? ???????? ???, ??? ?????????? ????????? ????? ?????? ? ??????? API Excel JavaScript.

## <a name="minimize-the-number-of-sync-calls"></a>?????????????? ?????????? ??????? sync ()

? Excel JavaScript API, ```sync()``` ???????? ???????????? ??????????? ?????????, ? ? ????????? ??????? ??? ????? ???? ?????????, ???????? ??? Excel Online. ????? ?????????????? ??????????????????, ????????????? ?????????? ??????? ```sync()```, ???????? ? ??????? ??????? ?????????, ??????? ????????, ?????? ??? ??????? ???.

??.?????? [???????? ??????? - ????????????? ()](excel-add-ins-core-concepts.md#sync) ??? ???????? ????, ??????? ??????? ???? ????????.

## <a name="minimize-the-number-of-proxy-objects-created"></a>?????????????? ?????????? ????????? ??????-????????

????????? ?????????? ???????? ?????? ? ???? ?? ??????-???????. ?????? ?????, ???? ??? ????? ???? ? ??? ?? ??????-?????? ??? ?????????? ????????, ???????? ??? ???? ??? ? ????????? ??? ??????????, ? ????? ??????????? ??? ?????????? ? ????? ????.

```javascript
// BAD: repeated calls to .getRange() to create the same proxy object
worksheet.getRange("A1").format.fill.color = "red";
worksheet.getRange("A1").numberFormat = "0.00%";
worksheet.getRange("A1").values = [[1]];

// GOOD: create the range proxy object once and assign to a variable
var range = worksheet.getRange("A1")
range.format.fill.color = "red";
range.numberFormat = "0.00%";
range.values = [[1]];

// ALSO GOOD: use a "set" method to immediately set all the properties without even needing to create a variable!
worksheet.getRange("A1").set({
    numberFormat: [["0.00%"]],
    values: [[1]],
    format: {
        fill: {
            color: "red"
        }
    }
});
```

## <a name="load-necessary-properties-only"></a>???????? ?????? ??????????? ???????

? Excel JavaScript API ??? ?????????? ???? ????????? ???????? ??????-???????. ???? ?? ?????? ????? ????????? ??? ???????? ? ?????? ```load()``` ???????, ???? ?????? ????? ????? ???????????? ????????? ???????. ?????? ????? ?? ?????????? ??? ????????? ?????? ??????????? ????????, ???????? ??? ??? ????????, ??????? ????? ??????? ?????????? ???????.

????????, ???? ?? ??????????? ??????? ???????? **address** ??????? range, ??? ?????? ?????? **load()** ??????? ?????? ??? ????????:
 
```js
range.load('address');
```
 
?? ?????? ??????? ????? **load()** ????? ?? ????????? ????????:
 
_?????????:_
 
```js
object.load(string: properties);
// or
object.load(array: properties);
// or
object.load({ loadOption });
```
 
_???:_
 
* `properties` ??? ?????? ??????? ??? ????????, ????????? ??? ?????? ? ?????????????-???????? ??? ??? ?????? ????. ?????????????? ???????? ??. ? ????????? ??????? **load()**, ???????????? ??? ???????? ? [??????????? ?? API JavaScript ??? Excel](https://dev.office.com/reference/add-ins/excel/excel-add-ins-reference-overview).
* `loadOption` ????????? ??????, ??????????? ????????? "???????", "??????????", "??????" ? "??????????". ?????????????? ???????? ??. ? ??????, ??????????? [?????????? ???????? ????????](https://dev.office.com/reference/add-ins/excel/loadoption).

???????, ??? ????????? ?????????? ??? ???????? ????? ????? ?? ?? ???, ??? ? ?????? ??????. ????????, `format` ???????? ????????? ??????? ?????????, ?? `format` ??? ?? ???? ???????? ????????. ????, ???? ?? ????????? ????????, `range.load("format")`, ??? ???????????? `range.format.load()`, ??????? ???????????? ????? ????? ?????? ???????? (), ??????? ????? ??????? ???????? ? ???????????????????, ??? ??????? ?????. ????? ????????  ?????, ??? ??? ?????? ????????? ?????? ????????? ????? ? ????????????? ????????. 

## <a name="suspend-calculation-temporarily"></a>???????? ???????????????? ??????

???? ?? ????????? ????????? ???????? ?? ??????? ?????????? ????? (????????, ????????? ???????? ????????? ??????? ?????????), ? ?? ?? ?????????? ???????? ????????????? ?????????? ? Excel ?? ????? ?????????? ????????, ?? ??????????? ????????????? ?????? ?? ?????????? ```context.sync()``` ??????.

??.?????? [?????? ??????????](https://dev.office.com/reference/add-ins/excel/application), ?????????? ???????????? ??? ????????? ?????????? ? ???, ??? ???????????? ```suspendApiCalculationUntilNextSync()``` API ??? ???????????? ? ?????????? ????????? ?????????? ????? ??????? ????????. ????????? ??? ?????????????, ??? ???????? ????????????? ??????:

```js
Excel.run(async function(ctx) {
    var app = ctx.workbook.application;
    var sheet = ctx.workbook.worksheets.getItem("sheet1");
    var rangeToSet: Excel.Range;
    var rangeToGet: Excel.Range;
    app.load("calculationMode");
    await ctx.sync();
    // Calculation mode should be "Automatic" by default
    console.log(app.calculationMode);
    
    rangeToSet = sheet.getRange("A1:C1");
    rangeToSet.values = [[1, 2, "=SUM(A1:B1)"]];
    rangeToGet = sheet.getRange("A1:C1");
    rangeToGet.load("values");
    await ctx.sync();
    // Range value should be [1, 2, 3] now
    console.log(rangeToGet.values);

    // Suspending recalc
    app.suspendApiCalculationUntilNextSync();
    rangeToSet = sheet.getRange("A1:B1");
    rangeToSet.values = [[10, 20]];
    rangeToGet = sheet.getRange("A1:C1");
    rangeToGet.load("values");
    app.load("calculationMode");
    await ctx.sync();
    // Range value should be [10, 20, 3] when we load the property, because calculation is suspended at that point
    console.log(rangeToGet.values);
    // Calculation mode should still be "Automatic" even with supend recalc
    console.log(app.calculationMode);

    rangeToGet.load("values");
    await ctx.sync();
    // Range value should be [10, 20, 30] when we load the property, because calculation is resumed after last sync
    console.log(rangeToGet.values);
})
```

## <a name="update-all-cells-in-a-range"></a>????????? ???? ????? ? ????????? 

????? ??? ????? ???????? ??? ?????? ? ????????? ? ????? ? ??? ?? ????????? ??? ?????????, ????? ???? ????? ??????? ?? ?????????? ????? ? ??????? ?????????? ???????, ??????? ??????????? ?????? ???? ? ?? ?? ????????, ????????? ??? ????? ??????? Excel ??????? ???????? ?? ???? ??????? ? ???????? ??? ????????? ?????? ????????. Excel ????? ????? ??????????? ?????? ?????????? ???? ????? ? ????????? ? ??? ?? ????????? ??? ?????????.

???? ??? ????? ????????? ???? ? ?? ?? ????????, ??? ?? ?????? ?????? ??? ?? ?? ??????? ??? ????????? ?????, ????? ?????????? ????????? ???? ???????? ?????? ??????? ????????. ??? ??????????? ??????? ??????????????????. ??? ??????? ????, ??????? ?????????? ???? ?????? ? ????????, ??.?????? [???????? ??????? -?????????? ???? ????? ? ?????????](excel-add-ins-core-concepts.md#update-all-cells-in-a-range).

??????? ????????, ? ??????? ?? ?????? ????????? ???? ??????, - ??? ????????? ?????? ???????? ????? ? ?????? ???????? ?? ?????. ? ???? ?????? ?? ?????? ?????? ????????? ???????? ???????? ? ???????? ?????? ????? ??? ??????? ??????? ? ????? ?????????. ????????????? ?????? ??????? ??? ????????, ??? ???????? ? [?????????? ???? ????? ? ?????????](excel-add-ins-core-concepts.md#update-all-cells-in-a-range) ??????? ????.

> [!NOTE]
> ???? ?? ??????????? TypeScript, ?? ???????? ?????? ??????????, ??????, ??? ???? ???????? ?? ????? ???? ??????????? ? 2D-??????.  ??? ?????????, ????????? ???????? *?????????* 2D-?????? ??? ?????????? ???????, ? TypeScript ?? ????????? ????????????? ?????? ????? setter vs getter.  ?????? ??????? ???????? ????? ???????? ???????????? ???????? ? ??????? ????????`as any`, ????????, `range.values = "hello world" as any`.

## <a name="importing-data-into-tables"></a>?????? ?????? ? ???????

??? ??????? ????????????? ???????? ?????????? ?????? ??????????????? ? [???????](https://dev.office.com/reference/add-ins/excel/table) ??????? (????????, ????????? `TableRowCollection.add()`), ?? ?????? ??????????? ? ?????? ???????????????????. ???? ?? ????????? ???????? ????? ???????, ??????? ?????????? ????????? ??????, ????????? `range.values`, ? ????? ????????? ????? `worksheet.tables.add()` ??? ???????? ??????? ?? ?????????. ???? ?? ????????? ???????? ?????? ? ???????????? ???????, ???????? ?????? ? ?????? ????????? ????? `table.getDataBodyRange()`, ? ??????? ????? ????????????? ???????????. 

??? ?????? ?????? ???????:

```js
Excel.run(async (ctx) => {
    var sheet = ctx.workbook.worksheets.getItem("Sheet1");
    // Write the data into the range first 
    var range = sheet.getRange("A1:B3");
    range.values = [["Key", "Value"], ["A", 1], ["B", 2]];

    // Create the table over the range
    var table = sheet.tables.add('A1:B3', true);
    table.name = "Example";
    await ctx.sync();


    // Insert a new row to the table
    table.getDataBodyRange().getRowsBelow(1).values = [["C", 3]];
    // Change a existing row value
    table.getDataBodyRange().getRow(1).values = [["D", 4]];
    await ctx.sync();
})
```

> [!NOTE]
> ?? ?????? ?????? ????????????? ?????? Table ? ?????? Range, ????????? [????? Table.convertToRange ()](https://dev.office.com/reference/add-ins/excel/table#converttorange) .

## <a name="see-also"></a>??. ?????

- [???????? ??????? API JavaScript ??? Excel](excel-add-ins-core-concepts.md)
- [??????? ???????, ????????? ? API JavaScript ??? Excel](excel-add-ins-advanced-concepts.md)
- [???????? ???????????? ?? API JavaScript ??? Excel](https://github.com/OfficeDev/office-js-docs/tree/ExcelJs_OpenSpec)
- [?????? Worksheet Functions (API JavaScript ??? Excel)](https://dev.office.com/reference/add-ins/excel/functions)

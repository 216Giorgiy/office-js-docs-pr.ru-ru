---
title: Совместное редактирование в надстройках Excel
description: ''
ms.date: 12/04/2017
ms.openlocfilehash: d0ef481f9efd6b977963091d5d0a123c30a5a789
ms.sourcegitcommit: c72c35e8389c47a795afbac1b2bcf98c8e216d82
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/23/2018
ms.locfileid: "19437572"
---
# <a name="coauthoring-in-excel-add-ins"></a><span data-ttu-id="c002b-102">Совместное редактирование в надстройках Excel</span><span class="sxs-lookup"><span data-stu-id="c002b-102">Coauthoring in Excel add-ins</span></span>  

<span data-ttu-id="c002b-103">Благодаря функции [совместного редактирования](https://support.office.com/en-US/article/Collaborate-on-Excel-workbooks-at-the-same-time-with-co-authoring-7152aa8b-b791-414c-a3bb-3024e46fb104) несколько человек могут работать вместе и редактировать одну и ту же книгу Excel одновременно.</span><span class="sxs-lookup"><span data-stu-id="c002b-103">With [coauthoring](https://support.office.com/en-US/article/Collaborate-on-Excel-workbooks-at-the-same-time-with-co-authoring-7152aa8b-b791-414c-a3bb-3024e46fb104), multiple people can work together and edit the same Excel workbook simultaneously.</span></span> <span data-ttu-id="c002b-104">Все соавторы книги могут видеть изменения, внесенные и сохраненные другими соавторами.</span><span class="sxs-lookup"><span data-stu-id="c002b-104">All coauthors of a workbook can see another coauthor's changes as soon as that coauthor saves the workbook.</span></span> <span data-ttu-id="c002b-105">Чтобы книги Excel можно было совместно редактировать, они должны храниться в OneDrive, OneDrive для бизнеса или SharePoint Online.</span><span class="sxs-lookup"><span data-stu-id="c002b-105">To coauthor an Excel workbook, the workbook must be stored in OneDrive, OneDrive for Business, or SharePoint Online.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="c002b-106">В Excel 2016 для Office 365 в левом верхнем углу можно заметить надпись "Автосохранение".</span><span class="sxs-lookup"><span data-stu-id="c002b-106">In Excel 2016 for Office 365, you will notice AutoSave in the upper-left corner.</span></span> <span data-ttu-id="c002b-107">Если автосохранение включено, соавторы видят внесенные вами изменения в режиме реального времени.</span><span class="sxs-lookup"><span data-stu-id="c002b-107">When AutoSave is turned on, coauthors see your changes in real time.</span></span> <span data-ttu-id="c002b-108">Учтите влияние такого поведения на макет вашей надстройки Excel.</span><span class="sxs-lookup"><span data-stu-id="c002b-108">Consider the impact of this behavior on the design of your Excel add-in.</span></span> <span data-ttu-id="c002b-109">Пользователи могут выключить автосохранение с помощью переключателя в левом верхнем углу окна Excel.</span><span class="sxs-lookup"><span data-stu-id="c002b-109">Users can turn off AutoSave via the switch in the upper left of the Excel window.</span></span>

<span data-ttu-id="c002b-110">Совместное редактирование доступно на следующих платформах:</span><span class="sxs-lookup"><span data-stu-id="c002b-110">Coauthoring is available on the following platforms:</span></span>

- <span data-ttu-id="c002b-111">Excel Online</span><span class="sxs-lookup"><span data-stu-id="c002b-111">Excel Online</span></span>
- <span data-ttu-id="c002b-112">Excel для Android</span><span class="sxs-lookup"><span data-stu-id="c002b-112">Excel for Android</span></span>
- <span data-ttu-id="c002b-113">Excel для iOS</span><span class="sxs-lookup"><span data-stu-id="c002b-113">Excel for iOS</span></span>
- <span data-ttu-id="c002b-114">Excel Mobile для Windows 10</span><span class="sxs-lookup"><span data-stu-id="c002b-114">Excel Mobile for Windows 10</span></span>
- <span data-ttu-id="c002b-115">Excel для компьютера с Windows для пользователей Office 365 (компьютер с версией Windows сборки 16.0.8326.2076 или выше, доступной для пользователей Current Branch с августа 2017 г.)</span><span class="sxs-lookup"><span data-stu-id="c002b-115">Excel for Windows Desktop for Office 365 customers (Windows desktop build 16.0.8326.2076 or later, which is available to current channel customers effective August 2017)</span></span>

## <a name="coauthoring-overview"></a><span data-ttu-id="c002b-116">Общие сведения о совместном редактировании</span><span class="sxs-lookup"><span data-stu-id="c002b-116">Coauthoring overview</span></span>
 
<span data-ttu-id="c002b-117">Когда вы меняете содержимое книги, Excel автоматически синхронизирует эти изменения для всех соавторов.</span><span class="sxs-lookup"><span data-stu-id="c002b-117">When you change a workbook's content, Excel automatically synchronizes those changes across all coauthors.</span></span> <span data-ttu-id="c002b-118">Вносить изменения в содержимое книги могут не только соавторы, но и код в надстройке Excel.</span><span class="sxs-lookup"><span data-stu-id="c002b-118">Coauthors can change the content of a workbook, but so can code running within an Excel add-in.</span></span> <span data-ttu-id="c002b-119">Например, для диапазона задается значение "Contoso", когда в надстройке Office выполняется следующий код JavaScript:</span><span class="sxs-lookup"><span data-stu-id="c002b-119">For example, when the following JavaScript code runs in an Office add-in, the value of a range is set to Contoso:</span></span>

```js
range.values = [['Contoso']];
```
<span data-ttu-id="c002b-120">После того как книга со значением "Contoso" синхронизируется для всех соавторов, новое значение диапазона будет доступно всем пользователям и надстройкам, выполняемым в той же книге.</span><span class="sxs-lookup"><span data-stu-id="c002b-120">After 'Contoso' synchronizes across all coauthors, any user or add-in running in the same workbook will see the new value of the range.</span></span> 

<span data-ttu-id="c002b-121">Функция совместного редактирования синхронизирует содержимое только общей книги.</span><span class="sxs-lookup"><span data-stu-id="c002b-121">Coauthoring only synchronizes the content within the shared workbook.</span></span> <span data-ttu-id="c002b-122">Значения, скопированные из книги в переменные JavaScript в надстройке Excel, не синхронизируются.</span><span class="sxs-lookup"><span data-stu-id="c002b-122">Values copied from the workbook to JavaScript variables in an Excel add-in are not synchronized.</span></span> <span data-ttu-id="c002b-123">Например, если надстройка хранит значение ячейки (например, "Contoso") в переменной JavaScript, а соавтор заменяет его на "Пример", после синхронизации все соавторы увидят в ячейке значение "Пример".</span><span class="sxs-lookup"><span data-stu-id="c002b-123">For example, if your add-in stores the value of a cell (such as 'Contoso') in a JavaScript variable, and then a coauthor changes the value of the cell to 'Example', after synchronization all coauthors see 'Example' in the cell.</span></span> <span data-ttu-id="c002b-124">Но для ячейки в переменной JavaScript по-прежнему будет задано значение "Contoso".</span><span class="sxs-lookup"><span data-stu-id="c002b-124">However, the value of the JavaScript variable is still set to 'Contoso'.</span></span> <span data-ttu-id="c002b-125">Кроме того, когда несколько соавторов используют одну и ту же надстройку, у каждого соавтора есть своя, не синхронизированная с остальными, копия переменной.</span><span class="sxs-lookup"><span data-stu-id="c002b-125">Furthermore, when multiple coauthors use the same add-in, each coauthor has their own copy of the variable, which is not synchronized.</span></span> <span data-ttu-id="c002b-126">Перед работой с переменными, использующими содержимое книги, убедитесь, что все значения в книге обновлены.</span><span class="sxs-lookup"><span data-stu-id="c002b-126">When you use variables that use workbook content, be sure you check for updated values in the workbook before you use the variable.</span></span> 

## <a name="use-events-to-manage-the-in-memory-state-of-your-add-in"></a><span data-ttu-id="c002b-127">Использование событий для управления состоянием надстройки в памяти</span><span class="sxs-lookup"><span data-stu-id="c002b-127">Use events to manage the in-memory state of your add-in</span></span>
 
<span data-ttu-id="c002b-128">Надстройки Excel могут читать содержимое книги (из скрытых листов и объекта параметра), а затем хранить его в таких структурах данных как переменные.</span><span class="sxs-lookup"><span data-stu-id="c002b-128">Excel add-ins can read workbook content (from hidden worksheets and a setting object), and then store it in data structures such as variables.</span></span> <span data-ttu-id="c002b-129">После того как исходные значения скопированы в любую из структур данных, соавторы могут обновить исходное содержание книги.</span><span class="sxs-lookup"><span data-stu-id="c002b-129">After the original values are copied into any of these data structures, coauthors can update the original workbook content.</span></span> <span data-ttu-id="c002b-130">Это означает, что теперь скопированные значения в структурах данных не синхронизируются с содержимым книги.</span><span class="sxs-lookup"><span data-stu-id="c002b-130">This means that the copied values in the data structures are now out of sync with the workbook content.</span></span> <span data-ttu-id="c002b-131">При создании надстроек необходимо учитывать это разделение содержания книги и значений, хранящихся в структурах данных.</span><span class="sxs-lookup"><span data-stu-id="c002b-131">When you build your add-ins, be sure to account for this separation of workbook content and values stored in data structures.</span></span>

<span data-ttu-id="c002b-132">Например, вы можете создать надстройку контента, которая отображает пользовательские визуализации.</span><span class="sxs-lookup"><span data-stu-id="c002b-132">For example, you might build a content add-in that displays custom visualizations.</span></span> <span data-ttu-id="c002b-133">Состояние ваших пользовательских визуализаций может быть сохранено в скрытом листе.</span><span class="sxs-lookup"><span data-stu-id="c002b-133">The state of your custom visualizations might be saved in a hidden worksheet.</span></span> <span data-ttu-id="c002b-134">Когда соавторы используют одну и ту же книгу, может возникнуть следующая ситуация:</span><span class="sxs-lookup"><span data-stu-id="c002b-134">When coauthors use the same workbook, the following scenario can occur:</span></span>

- <span data-ttu-id="c002b-135">Пользователь A открывает документ, и пользовательские визуализации отображаются в книге.</span><span class="sxs-lookup"><span data-stu-id="c002b-135">User A opens the document and the custom visualizations are shown in the workbook.</span></span> <span data-ttu-id="c002b-136">Пользовательские визуализации читают данные из скрытого листа (например, задан синий цвет визуализации).</span><span class="sxs-lookup"><span data-stu-id="c002b-136">The custom visualizations read data from a hidden worksheet (for example, the color of the visualizations is set to blue).</span></span>
- <span data-ttu-id="c002b-137">Пользователь Б открывает тот же документ, начинает изменять пользовательские визуализации</span><span class="sxs-lookup"><span data-stu-id="c002b-137">User B opens the same document, and starts modifying the custom visualizations.</span></span> <span data-ttu-id="c002b-138">и в качестве цвета для них задает оранжевый.</span><span class="sxs-lookup"><span data-stu-id="c002b-138">User B sets the color of the custom visualizations to orange.</span></span> <span data-ttu-id="c002b-139">Оранжевый цвет сохраняется в скрытом листе.</span><span class="sxs-lookup"><span data-stu-id="c002b-139">Orange is saved to the hidden worksheet.</span></span>
- <span data-ttu-id="c002b-140">Скрытый лист пользователя А обновляется с учетом оранжевого цвета.</span><span class="sxs-lookup"><span data-stu-id="c002b-140">User A's hidden worksheet is updated with the new value of orange.</span></span>
- <span data-ttu-id="c002b-141">Специальные элементы визуализации пользователя А по-прежнему синие.</span><span class="sxs-lookup"><span data-stu-id="c002b-141">User A's custom visualizations are still blue.</span></span> 

<span data-ttu-id="c002b-142">Чтобы специальные элементы визуализации пользователя А соответствовали изменениям, внесенным соавторами на скрытом листе, используйте событие [BindingDataChanged](https://dev.office.com/reference/add-ins/shared/binding.bindingdatachangedevent).</span><span class="sxs-lookup"><span data-stu-id="c002b-142">If you want User A's custom visualizations to respond to changes made by coauthors on the hidden worksheet, use the [BindingDataChanged](https://dev.office.com/reference/add-ins/shared/binding.bindingdatachangedevent) event.</span></span> <span data-ttu-id="c002b-143">Это обеспечит отражение изменений, внесенных соавторами в содержимое книги, в вашей надстройке.</span><span class="sxs-lookup"><span data-stu-id="c002b-143">This ensures that changes to workbook content made by coauthors is reflected in the state of your add-in.</span></span>

## <a name="caveats-to-using-events-with-coauthoring"></a><span data-ttu-id="c002b-144">Предостережения, касающиеся использования событий для совместного редактирования</span><span class="sxs-lookup"><span data-stu-id="c002b-144">Caveats to using events with coauthoring</span></span> 

<span data-ttu-id="c002b-145">Как описано выше, в некоторых сценариях применениетриггеров события для всех соавторов обеспечивает улучшенное взаимодействие с пользователем.</span><span class="sxs-lookup"><span data-stu-id="c002b-145">As described earlier, in some scenarios, triggering events for all coauthors provides an improved user experience.</span></span> <span data-ttu-id="c002b-146">Однако, имейте ввиду, что в ряде сценариев такое поведение может привести к неудобствам в работе пользователей.</span><span class="sxs-lookup"><span data-stu-id="c002b-146">However, be aware that in some scenarios this behavior can produce poor user experiences.</span></span> 

<span data-ttu-id="c002b-147">Например, обычно в сценариях проверки данных пользовательский интерфейс отображается в ответ на события.</span><span class="sxs-lookup"><span data-stu-id="c002b-147">For example, in data validation scenarios, it is common to display UI in response to events.</span></span> <span data-ttu-id="c002b-148">Событие [BindingDataChanged](https://dev.office.com/reference/add-ins/shared/binding.bindingdatachangedevent), описанное в предыдущем разделе, выполняется когда локальный пользователь или соавтор (удаленный) изменяет содержимое книги в пределах привязки.</span><span class="sxs-lookup"><span data-stu-id="c002b-148">The [BindingDataChanged](https://dev.office.com/reference/add-ins/shared/binding.bindingdatachangedevent) event described in the previous section runs when either a local user or coauthor (remote) changes the workbook content within the binding.</span></span> <span data-ttu-id="c002b-149">Если обработчик событий отображает пользовательский интерфейс в ответ на событие **BindingDataChanged**, пользователи увидят пользовательский интерфейс, не связанный с изменениями, над которыми они работали в книге, что приведет к определенным неудобствам.</span><span class="sxs-lookup"><span data-stu-id="c002b-149">If the event handler of the **BindingDataChanged** event displays UI, users will see UI that is unrelated to changes they were working on in the workbook, leading to a poor user experience.</span></span> <span data-ttu-id="c002b-150">Избегайте отображения пользовательского интерфейса при использовании событий в вашей надстройке.</span><span class="sxs-lookup"><span data-stu-id="c002b-150">Avoid displaying UI when using events in your add-in.</span></span>

## <a name="see-also"></a><span data-ttu-id="c002b-151">См. также</span><span class="sxs-lookup"><span data-stu-id="c002b-151">See also</span></span> 

- [<span data-ttu-id="c002b-152">О совместном редактировании в Excel (VBA)</span><span class="sxs-lookup"><span data-stu-id="c002b-152">About coauthoring in Excel (VBA)</span></span>](https://msdn.microsoft.com/en-us/vba/excel-vba/articles/about-coauthoring-in-excel) 
- [<span data-ttu-id="c002b-153">Как автосохранение влияет на надстройки и макросы (VBA)</span><span class="sxs-lookup"><span data-stu-id="c002b-153">How AutoSave impacts add-ins and macros (VBA)</span></span>](https://msdn.microsoft.com/en-us/vba/office-shared-vba/articles/how-autosave-impacts-addins-and-macros) 

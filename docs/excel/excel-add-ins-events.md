---
title: ?????? ? ????????? ??? ?????? API JavaScript ??? Excel
description: ''
ms.date: 05/25/2018
ms.openlocfilehash: b928910cc673cfe8ff99906259b51fa2c3afdca4
ms.sourcegitcommit: 17f60431644b448a4816913039aaebfa328f9b0a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/25/2018
---
# <a name="work-with-events-using-the-excel-javascript-api"></a>?????? ? ????????? ??? ?????? API JavaScript ??? Excel 

? ???? ?????? ??????????? ?????? ???????, ??????????? ? ?????? ? ????????? ? Excel, ? ????? ???????????? ??????? ????, ?????????????? ???????????, ????????????? ? ???????? ???????????? ??????? ??? ?????? API JavaScript ??? Excel. 

## <a name="events-in-excel"></a>??????? ? Excel

?????? ???, ????? ? ????? Excel ?????????? ????????? ????????????? ????, ??????????? ??????????? ? ???????. ? ??????? API JavaScript ??? Excel ????? ?????????????? ??????????? ???????, ??????????? ?????????? ????????????? ????????? ??????????? ??????? ??? ????????????? ????????????? ???????. ???? ??????????? ?????????????? ? ????????? ????? ???????.

| ??????? | ???????? | ?????????????? ??????? |
|:---------------|:-------------|:-----------|
| `onAdded` | ???????, ??????????? ??? ?????????? ???????. | [**WorksheetCollection**](https://dev.office.com/reference/add-ins/excel/worksheetcollection) |
| `onDeleted` | ???????, ??????????? ??? ???????? ???????. | [**WorksheetCollection**](https://dev.office.com/reference/add-ins/excel/worksheetcollection) |
| `onActivated` | ???????, ??????????? ??? ????????? ???????. | [**WorksheetCollection**](https://dev.office.com/reference/add-ins/excel/worksheetcollection), [**Worksheet**](https://dev.office.com/reference/add-ins/excel/worksheet) |
| `onDeactivated` | ???????, ??????????? ??? ?????????? ???????. | [**WorksheetCollection**](https://dev.office.com/reference/add-ins/excel/worksheetcollection), [**Worksheet**](https://dev.office.com/reference/add-ins/excel/worksheet) |
| `onChanged` | ???????, ??????????? ??? ????????? ?????? ? ???????. | [**????**](https://dev.office.com/reference/add-ins/excel/worksheet), [**???????**](https://dev.office.com/reference/add-ins/excel/table), [**TableCollection**](https://dev.office.com/reference/add-ins/excel/tablecollection) |
| `onDataChanged` | ???????, ??????????? ??? ????????? ?????? ??? ?????????????? ? ????????. | [**????????**](https://dev.office.com/reference/add-ins/excel/binding) |
| `onSelectionChanged` | ???????, ??????????? ??? ????????? ???????? ?????? ??? ?????????? ?????????. | [**????**](https://dev.office.com/reference/add-ins/excel/worksheet), [**???????**](https://dev.office.com/reference/add-ins/excel/table), [**????????**](https://dev.office.com/reference/add-ins/excel/binding) |

### <a name="event-triggers"></a>???????? ???????

??????? ? ????? Excel ????? ??????????:

- ??? ?????????????? ???????????? ? ??????????? Excel, ???????? ????????? ? ?????;
- ?? ???? (JavaScript) ?????????? Office, ????????? ????????? ? ?????;
- ?? ???? (???????) ?????????? VBA, ????????? ????????? ? ?????.

????? ?????????, ??????????????? ???????????? ????????? Excel, ???????? ??????????????? ??????? ? ?????.

### <a name="lifecycle-of-an-event-handler"></a>????????? ???? ??????????? ???????

?????????? ??????? ?????????, ????? ?????????? ???????????? ???, ? ????????? ??? ?????? ??? ??????????? ??? ???????? ??????????. ??????????? ??????? ?? ???????? ? ??????? ????? Excel.

### <a name="events-and-coauthoring"></a>??????? ? ?????????? ??????????????

????????? ??????? ????? ???????? ?????? ? [???????????? ?????????????](co-authoring-in-excel-add-ins.md) ???? ????? Excel. ??? ???????, ??????? ????? ??????? ???????, ? ????????? `onChanged`, ??????????????? ?????? **Event** ????? ????????? ???????? **source**, ???????????, ??? ???? ??????? ???????: ????????? ????????????? (`event.source = Local`) ??? ????????? ????????? (`event.source = Remote`).

## <a name="register-an-event-handler"></a>??????????? ??????????? ???????

? ??????????? ???? ??????? ???? ?????????????? ?????????? ??????? `onChanged` ?? ????? ??? ????????? **Sample**. ? ???? ???? ???????, ??? ??? ????????? ?????? ?? ???? ????? ?????? ??????????? ??????? `handleDataChange`.

```js
Excel.run(function (context) {
    var worksheet = context.workbook.worksheets.getItem("Sample");
    worksheet.onChanged.add(handleChange);

    return context.sync()
        .then(function () {
            console.log("Event handler successfully registered for onChanged event in the worksheet.");
        });
}).catch(errorHandlerFunction);
```

## <a name="handle-an-event"></a>????????? ???????

??? ???????? ? ?????????? ???????, ??? ??????????? ??????????? ??????? ?? ??????? ???????, ??????? ?????? ??????????? ??? ????????????? ?????????? ???????. ?? ?????? ????????? ??? ??????? ?? ?????????? ????? ????????, ??????????? ??? ?????? ????????. ? ??????????? ???? ??????? ???? ???????? ??????? ??????????? ???????, ??????? ?????? ?????????? ???????? ? ??????? ? ???????. 

```js
function handleChange(event)
{ 
    return Excel.run(function(context){
        return context.sync()
            .then(function() {
                console.log("Change type of event: " + event.changeType);
                console.log("Address of event: " + event.address);
                console.log("Source of event: " + event.source);
            });
    }).catch(errorHandlerFunction);
}
```

## <a name="remove-an-event-handler"></a>???????? ??????????? ???????

? ??????????? ???? ??????? ???? ?????????????? ?????????? ??????? `onSelectionChanged` ?? ????? ??? ????????? **Sample** ? ???????????? ??????? `handleSelectionChange`, ??????? ????? ??????????? ??? ????????????? ???????. ? ??? ????? ???????????? ??????? `remove()`, ??????? ????? ???????????? ??????? ??? ???????? ??????????? ???????.

```js
var eventResult;

Excel.run(function (context) {
    var worksheet = context.workbook.worksheets.getItem("Sample");
    eventResult = worksheet.onSelectionChanged.add(handleSelectionChange);

    return context.sync()
        .then(function () {
            console.log("Event handler successfully registered for onSelectionChanged event in the worksheet.");
        });
}).catch(errorHandlerFunction);

function handleSelectionChange(event)
{ 
    return Excel.run(function(context){
        return context.sync()
            .then(function() {
                console.log("Address of current selection: " + event.address);
            });
    }).catch(errorHandlerFunction);
}

function remove() {
    return Excel.run(eventResult.context, function (context) {
        eventResult.remove();
        
        return context.sync()
            .then(function() {
                eventResult = null;
                console.log("Event handler successfully removed.");
            });
    }).catch(errorHandlerFunction);
}
```

## <a name="see-also"></a>??. ?????

- [???????? ??????? API JavaScript ??? Excel](excel-add-ins-core-concepts.md)
- [???????? ???????????? ?? API JavaScript ??? Excel](https://github.com/OfficeDev/office-js-docs/tree/ExcelJs_OpenSpec)
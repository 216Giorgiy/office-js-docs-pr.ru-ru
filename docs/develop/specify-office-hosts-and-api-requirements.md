---
title: ???????? ??????? ?????????? Office ? ?????????? ? API
description: ''
ms.date: 12/04/2017
ms.openlocfilehash: bd517dee1faf8d3f3009a0b9ce7127f5760e730d
ms.sourcegitcommit: c72c35e8389c47a795afbac1b2bcf98c8e216d82
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/23/2018
---
# <a name="specify-office-hosts-and-api-requirements"></a>???????? ??????? ?????????? Office ? ?????????? ? API

?????? ?????????? Office ????? ???????? ?? ???????? ?????????? Office, ?????? ??????????, ???????? ??? ?????? API. ????????, ?????????? ?????:

- ???????? ? ????? (Word ??? Excel) ??? ?????????? ??????????? Office;
    
- ???????????? API JavaScript, ????????? ?????? ? ????????? ??????? Office. ????????, ????? ??????? ?????????? Excel 2016 ?? ???? ????? API JavaScript ??? Excel; 
    
- ???????? ?????? ? ??????? Office, ??????? ???????????? ???????? API, ???????????? ????? ???????????.
    
??? ?????? ??????? ??? ???????????, ????? ????????? ??????? ??????? ??? ?????????? ?????? ?????????? ? ????????????? ?????? ?????????.

> [!NOTE]
> ????? ???????? ? ???, ?? ????? ?????????? ?????????????? ?????????? Office, ??. ? [???? ??????](../overview/office-add-in-availability.md). 

? ??????? ???? ??????????? ???????? ???????, ??????????????? ? ???? ??????.

|**?????????**|**????????**|
|:-----|:-----|
|?????????? Office, ??????? ?????????? Office ??? ??????? ??????????|?????????? Office, ???????????? ??? ??????? ??????????, ???????? Word, Word Online, Excel ? ?. ?.|
|?????????|????????? ???????? ?????????? Office, ???????? Office Online ??? Office ??? iPad.|
|????? ???????????? ?????????|??????????? ?????? ????????? ????????? API. ? ??????? ??????? ?????????? ?????????? ??????????, ???????????? ?? ??????? ?????????? Office ???????? API, ??????? ??? ??????????. ????? ????????? ????????? ?????? ??????????, ? ?? ????????? ????????? API. ????????? ?????? ?????????? ??????? ?? ???????? ?????????? Office ? ??? ??????. <br >?????? ?????????? ??????????? ? ????? ?????????. ??????? ?????? ?????????? ? ?????????, ?? ??????????, ????? ??????????? ??????? ????????? API ?????? ?????????? ??????? ?????????? Office, ????? ????? ???? ????????? ??????????. ?????????? ?? ????? ???????? ? ??????? ??????????? Office, ??????? ?? ???????????? ?????? ??????????, ????????? ? ?????????, ? ?? ????? ???????????? ? ??????? <span class="ui">??? ??????????</span>. ??? ???????????? ??????????? ??????????.? ???? ? ??????? ???????? ? ????? ??????????. ?????? ?????? ??????? ?????????? ??. ? ??????[?????? ?????????? ??? ????????? Office](https://dev.office.com/reference/add-ins/requirement-sets/office-add-in-requirement-sets).|
|???????? ? ????? ??????????|???????? ? ????? ??????????, ??????? ????????? ??????????, ???????????? ?? ??????? ?????????? Office ?????? ?????????? ??? ??????, ??????? ?????????? ??????????. ????? ????????? ????? ????????, ??????????? ???????? **if** ? ??????? **isSetSupported**, ???????? ?????????? ??? ??????? ???????, ??????? ?? ?????? ? ????? ??????????. ???????? ? ????? ?????????? ????????? ??????????? ????????? ????????? ??????????. ? ??????? ?? ??????? ??????????, ????? ???????? ?? ????????? ?????? ??????????? ??????? ????????? API, ??????? ????????? ??? ??????? ??????????. ?????? ????? ? ??????? ????????? **if** ?? ???????????, ?????????????? ?? ??????? API, ? ???? ??? ???, ?????????? ? ?????????? ?????????????? ???????. ???? ?? ??????????? ???????? ? ????? ??????????, ???? ?????????? ?????? ????? ???????????? ? ??????? **??? ??????????**.|

## <a name="before-you-begin"></a>????? ??????? ??????

?????????? ?????? ???????????? ????????? ?????? ????? ????????? ??????????. ???? ?? ??????????? ???????? ? ????? ??????????, ??????????? ????????? ?????? ?????????? API JavaScript ??? Office (office.js).

### <a name="specify-the-latest-add-in-manifest-schema"></a>????? ????????? ?????? ????? ?????????? ?????????

???? ?????????? ?????? ???????????? ????? ????????? 1.1. ????????? ??????? **OfficeApp** ? ????????? ?????????? ????????? ???? ???????.

```XML
<OfficeApp xmlns="http://schemas.microsoft.com/office/appforoffice/1.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="TaskPaneApp">
```

### <a name="specify-the-latest-javascript-api-for-office-library"></a>????? ????????? ?????? ?????????? API JavaScript ??? Office

???? ?? ??????????? ???????? ? ????? ??????????, ?? ??? ?????????? ????????? ?? ????????? ?????? ?????????? API JavaScript ??? Office ?? ???? ???????? ???????????. ??? ????? ???????? ????????? ???? ??? `script` ? HTML-???. ????? ?????? ????????? ?? ????????? ?????? ????? Office.js, ??????????? `/1/` ? URL-?????? ???? ???????? ???????????.

```HTML
<script src="https://appsforoffice.microsoft.com/lib/1/hosted/Office.js" type="text/javascript"></script>
```

## <a name="options-to-specify-office-hosts-or-api-requirements"></a>????????? ??? ??????? ??????? ?????????? Office ??? ?????????? ? API

??? ???????? ??????? ?????????? Office ? ?????????? ? API ?????????? ????????? ????????? ????????. ?? ????????? ????? ????????, ??? ??????? ?????????? ????? ??? ??????????.

![????? ?????? ??????????? ???????? ???????? ??????? ?????????? Office ??? ????????? API ??? ??????????](../images/options-for-office-hosts.png)

- ???? ???? ?????????? ???????? ? ????? ?????????? Office, ??????? ??????? **Hosts** ? ?????????. ?????????????? ???????? ??. ? ??????? [??????? ???????? Hosts](#set-the-hosts-element).
    
- ????? ?????? ??????????? ????? ?????????? ??? ???????? API, ??????? ?????? ???????????? ??????? ?????????? Office ??? ??????? ??????????, ??????? ??????? **Requirements** ? ?????????. ?????????????? ???????? ??. ? ??????? [??????? ???????? Requirements ? ?????????](#set-the-requirements-element-in-the-manifest).
    
- ????? ???????????? ?????????????? ???????, ???? ???????????? ?????? ?????????? ??? ???????? API ???????? ? ??????? ?????????? Office, ????????? ???????? ? ????? ?????????? ??? ???? JavaScript ??????????. ????????, ???? ?????????? ??????????? ? Excel 2016, ??????????? ???????? ?????? API JavaScript ??? Excel, ????? ???????????? ?????????????? ???????. ?????????????? ???????? ??. ? ??????? [????????????? ???????? ? ????? ?????????? ??? ???? JavaScript](#use-runtime-checks-in-your-javascript-code).
    
## <a name="set-the-hosts-element"></a>??????? ???????? Hosts

????? ?????????? ???????? ? ????? ??????? ?????????? Office, ??????????? ???????? **Hosts** ? **Host** ? ?????????. ???? ??????? **Hosts** ?? ??????, ?????????? ????? ???????? ?? ???? ??????? ???????????.

????????, ????????? ???? ?????????? **Hosts** ? **Host** ?????????, ??? ?????????? ????? ???????? ? ????? ???????? Excel, ??????? Excel ??? Windows, Excel Online ? Excel ??? iPad.

```xml
<Hosts>
  <Host Name="Workbook" />
</Hosts>
```

??????? **Hosts** ????? ????????? ???? ??? ????????? ????????? **Host**. ??????? **Host** ????????? ??????? ?????????? Office, ? ??????? ????? ???????? ???? ??????????. ????????????? ???????? **Name** ????? ????????? ???? ?? ????????? ???? ????????.

| ???          | ??????? ?????????? Office                      |
|:--------------|:----------------------------------------------|
| ???? ??????      | ???-?????????? Access                               |
| ????????      | Word ??? Windows, Mac, iPad ? Word Online        |
| ???????? ????       | Outlook ??? Windows, Mac, Outlook ? ????????? ? Outlook.com | 
| ???????????  | PowerPoint ??? Windows, Mac, iPad ? PowerPoint Online  |
| ??????       | ??????                                       |
| ?????      | Excel ??? Windows, Mac, iPad ? Excel Online           |

> [!NOTE]
> ??????? `Name` ????????? ?????????? Office, ? ??????? ????? ??????????? ???? ??????????. ?????????? Office ?????????????? ?? ?????? ?????????? ? ???????? ?? ?????????? ??, ? ???-?????????, ?? ????????? ? ????????? ???????????. ?????? ??????? ?????????, ?? ??????? ????? ????????? ??????????. ????????, ???? ?? ??????? `Mailbox`, ?? ??? ??????? ?????????? ????? ????? ???????????? ? Outlook, ? Outlook Web App. 


## <a name="set-the-requirements-element-in-the-manifest"></a>???????? ???????? Requirements ? ?????????

? ??????? ???????? **Requirements** ????? ?????? ??????????? ?????? ?????????? ??? ???????? API, ??????? ?????? ???????????? ??????? ?????????? Office ??? ??????? ??????????. ? ???????? **Requirements** ????? ??????? ??? ?????? ??????????, ??? ? ????????? ??????, ???????????? ? ??????????. ? ?????? 1.1 ????? ?????????? ????????? ??????? **Requirements** ???????????? ??? ???? ?????????, ????? ????????? Outlook.

> [!WARNING]
> ??????????? ??????? **Requirements**, ?????? ????? ??????? ???????? ???????? API, ??????? ?????? ???????????? ??????????. ???? ????????? ??? ??????? ?????????? Office ?? ???????????? ???????? API, ????????? ? ???????? **Requirements**, ?????????? ?? ????? ???????? ? ???? ??????? ?????????? ??? ?? ???? ?????????, ? ????? ?? ????? ???????????? ? ??????? **My Add-ins**. ??????????? ??????? ?????????? ????????? ?? ???? ?????????? ???????? ?????????? Office, ???????? Excel ??? Windows, Excel Online ? Excel ??? iPad. ????? ?????????? ???? ????????? ?? _????_ ??????????? Office ? ?? ???? ??????????, ??????????? ???????? ? ????? ??????????, ? ?? ??????? **Requirements**.

? ??????? ???? ???? ???????? ??????????, ??????? ??????????? ?? ???? ??????? ??????????? Office, ?????????????? ????????? ???? ????????.

-  ????? ?????????? **TableBindings** 1.1 ??? ????? ??????? ??????.
    
-  ????? ?????????? **OOXML** 1.1 ??? ????? ??????? ??????.
    
-  ????? **Document.getSelectedDataAsync**.

```XML
<Requirements>
   <Sets DefaultMinVersion="1.1">
      <Set Name="TableBindings" MinVersion="1.1"/>
      <Set Name="OOXML" MinVersion="1.1"/>
   </Sets>
   <Methods>
      <Method Name="Document.getSelectedDataAsync"/>
   </Methods>
</Requirements>
```

- ??????? **Requirements** ???????? ???????? ???????? **Sets** ? **Methods**.
    
- ??????? **Sets** ????? ????????? ???? ??? ????????? ????????? **Set**. ???????? **DefaultMinVersion** ?????? ???????? **MinVersion** ?? ????????? ??? ???? ???????? ????????? **Set**.
    
- ??????? **Set** ????????? ?????? ??????????, ??????? ??????? ?????????? Office ?????? ???????????? ??? ??????? ??????????. ??????? **Name** ????????? ??? ?????? ??????????. ??????? **MinVersion** ????????? ??????????? ?????? ?????? ??????????. **MinVersion** ?????????????? ???????? **DefaultMinVersion**. ?????????????? ???????? ? ??????? ?????????? ? ?? ???????, ? ??????? ??????????? ???????? API, ??. ? ?????? [?????? ?????????? ??? ????????? Office](https://dev.office.com/reference/add-ins/office-add-in-requirement-sets).
    
- ??????? **Methods** ????? ????????? ???? ??? ????????? ????????? **Method**. ??????? **Methods** ?? ??????? ???????????? ? ???????????? Outlook.
    
- ??????? **Method** ?????? ????????? ?????, ??????? ?????? ???????????? ??????? ?????????? Office, ? ??????? ???????? ??????????. ??????? **Name** ?????????? ? ????????? ??? ?????? ? ??? ???????????? ????????.
    

## <a name="use-runtime-checks-in-your-javascript-code"></a>????????????? ???????? ? ????? ?????????? ??? ???? JavaScript


???? ??????? ?????????? Office ???????????? ???????????? ?????? ??????????, ?? ?????? ???????? ? ?????????? ?????????????? ???????. ????????, ???? ?????????? ???????? ? Word 2016, ?? ?????? ???????????? ? ??? ????? API JavaScript ??? Word. ??? ????? ??????????? ????? **isSetSupported** ? ?????? ?????? ??????????. ? ????? ?????????? ????? **isSetSupported** ??????????, ?????????????? ?? ????? ?????????? ??????? ??????????? Office, ? ??????? ???????? ??????????. ???? ?? ??????????????, ?? ????? **isSetSupported** ?????????? ???????? **true** ? ????????? ?????????????? ???, ??????? ?????????? ???????? API ?? ????? ??????. ???? ?????????? Office ?? ???????????? ????? ??????????, ????? **isSetSupported** ?????????? ???????? **false**, ? ?????????????? ??? ?? ???????????. ? ???? ???? ??????? ?????????, ??????? ?????????? ???????????? ? ??????? **isSetSupported**.


```js
if (Office.context.requirements.isSetSupported(RequirementSetName , VersionNumber))
{
   // Code that uses API members from RequirementSetName.
}

```


-  _RequirementSetName_ (???????????? ????????) ? ??? ??? ?????? ??????????. ?????????????? ???????? ? ????????? ??????? ?????????? ??. ? ?????? [?????? ?????????? ??? ????????? Office](https://dev.office.com/reference/add-ins/office-add-in-requirement-sets).
    
-  _VersionNumber_ (?????????????? ????????) ? ??? ?????? ?????? ??????????.
    
? Excel 2016 ??? Word 2016 ??? ??????? ?????????? **ExcelAPI** ??? **WordAPI** ??????????? ????? **isSetSupported**. ????? **isSetSupported**, ? ????? ?????? ?????????? **ExcelAPI** ? **WordAPI** ???????? ? ????????? ?????? ????? Office.js ? CDN. ???? ?? ?? ??????????? ???? Office.js ?? CDN, ?????????? ????? ????????? ??????????, ??? ??? ????? **isSetSupported** ?? ????? ?????????. ?????????????? ???????? ??. ? ?????? [????? ????????? ?????? ?????????? API JavaScript ??? Office](#specify-the-latest-javascript-api-for-office-library). 


> [!NOTE]
> ????? **isSetSupported** ?? ???????? ? Outlook ? Outlook Web App. ????? ???????????? ???????? ? ????? ?????????? ? Outlook ??? Outlook Web App, ??????????? ??????, ????????? ? ??????? [???????? ? ????? ?????????? ? ?????????????? ???????, ?? ???????? ? ????? ??????????](#runtime-checks-using-methods-not-in-a-requirement-set).

? ??????????? ???? ??????? ???? ????????, ??? ???????????????? ?????????? ????? ?????????? ? ??????? ??????????? Office, ?????????????? ?????? ?????? ?????????? ??? ???????? API.




```js
if (Office.context.requirements.isSetSupported('WordApi', 1.1))
{
    // Run code that provides additional functionality using the JavaScript API for Word when the add-in runs in Word 2016.
}
else if (Office.context.requirements.isSetSupported('CustomXmlParts'))
{
      // Run code that uses API members from the CustomXmlParts requirement set.
}
else 
{
    // Run additional code when the Office host is not Word 2016, and when the Office host does not support the CustomXmlParts requirement set.
}

```


## <a name="runtime-checks-using-methods-not-in-a-requirement-set"></a>???????? ? ????? ?????????? ? ?????????????? ???????, ?? ???????? ? ????? ??????????


????????? ???????? API ?? ?????? ? ?????? ??????????. ??? ????????? ?????? ? ??? ????????? API, ??????? ?????? ? ???????????? ???? [JavaScript ??? Office](https://dev.office.com/reference/add-ins/javascript-api-for-office) (??? ???????? ? Office.), ? ?? ????????? ? ????????? API, ????????????? ? ????????????? ???? API JavaScript ??? Word (??? ???????? ? Word.) ??? [API JavaScript ??? ????????? Excel](https://dev.office.com/reference/add-ins/excel/excel-add-ins-reference-overview) (??? ???????? ? Excel.). ???? ?????????? ??????? ?? ??????, ?? ????????? ? ????? ??????????, ?? ?????? ???????????? ???????? ? ????? ??????????, ????? ??????????, ?????????????? ?? ????? ??????? ??????????? Office, ??? ???????? ? ??????? ???? ????. ?????? ???? ???????, ?? ???????? ? ????? ??????????, ??. ? ?????? [?????? ?????????? ??? ????????? Office](https://dev.office.com/reference/add-ins/office-add-in-requirement-sets).


> [!NOTE]
> ??????????? ?????????? ????????????? ????? ???? ???????? ? ????? ?????????? ? ???? ??????????.

? ??????? ???? ???? ????????, ??? ?????????, ???????????? ?? ??????? ?????????? ????? **document.setSelectedDataAsync**.




```js
if (Office.context.document.setSelectedDataAsync)
{
    // Run code that uses document.setSelectedDataAsync.
}
```


## <a name="see-also"></a>??. ?????

- [XML-???????? ?????????? Office](add-in-manifests.md)
- [?????? ???????????? ????????? ??? ????????? Office](https://dev.office.com/reference/add-ins/requirement-sets/office-add-in-requirement-sets)
- [Word-Add-in-Get-Set-EditOpen-XML](https://github.com/OfficeDev/Word-Add-in-Get-Set-EditOpen-XML)
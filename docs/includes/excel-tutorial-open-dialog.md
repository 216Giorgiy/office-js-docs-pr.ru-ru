?? ?????? ?????????????? ?????, ????????? ? ???????????, ?? ???????? ?????????? ???? ? ????? ??????????, ?????????? ????????? ?? ???????? ??????????? ???? ? ??????? ??????? ????? ? ???????? ?????????? ????. ?????????? ???? ?????????? Office *?? ?????????*: ???????????? ????? ?????????? ???????? ? ? ?????????? ? ??????? ?????????? Office, ? ? ??????? ????????? ? ??????? ?????.

> [!NOTE]
> ??? ???? ?? ???????? ??????????? ?? ??????????? Excel. ???? ?? ??????? ?? ??? ???????? ?? ???????? ??????????? ????????? ??????? ??? ?? ?????? ?????? ??????, ????????? ?? ??????? ???????? [??????????? ?? ??????????? Excel](../tutorials/excel-tutorial.yml), ????? ?????? ???????? ? ?????? ??????.

## <a name="create-the-dialog-page"></a>???????? ???????? ??????????? ????

1. ???????? ?????? ? ????????? ????.
2. ???????? ? ???????? ????? ??????? (??? ????????? index.html) ???? popup.html.
3. ???????? ? ???? popup.html ??????????? ???? ???. ???????? ????????:
   - ?? ???????? ????????? `<input>`, ??? ???????????? ????? ??????? ???? ???, ? ??????, ??? ??????? ??????? ??? ????? ?????????? ?? ???????? ??????? ?????, ??? ??? ???????????.
   - ??? ????????? ?????? ??? ????????? popup.js, ??????? ????? ?????? ?? ????? ??????? ?????.
   - ?? ????????? ????? ?????????? Office.JS ? jQuery, ??? ??? ??? ????? ?????????????? ? popup.js.

    ```html
    <!DOCTYPE html>
    <html>
        <head lang="en">
            <title>Dialog for My Office Add-in</title>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1">
        
            <link rel="stylesheet" href="node_modules/office-ui-fabric-js/dist/css/fabric.min.css" />
            <link rel="stylesheet" href="node_modules/office-ui-fabric-js/dist/css/fabric.components.css" />
            <link rel="stylesheet" href="app.css">
    
            <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script>
            <script type="text/javascript" src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-2.2.1.min.js"></script>
            <script type="text/javascript" src="popup.js"></script>
    
        </head>
         <body style="display:flex;flex-direction:column;align-items:center;justify-content:center">
         <div class="padding">
            <p class="ms-font-xl">ENTER YOUR NAME</p>
         </div>        
        <div class="padding">
            <input id="name-box" type="text"/>
        <div>
        <div class="padding">
            <button id="ok-button" class="ms-Button">OK</button>
        </div>
    </body>
    </html>
    ```

4. ???????? ? ???????? ????? ??????? ???? popup.js.
5. ???????? ? ???? popup.js ??????????? ???? ???. ???????? ????????:
   - *?????? ????????, ?????????? API ? ?????????? Office.JS, ?????? ????????? ??????? ???????? `Office.initialize`.* ???? ? ????????????? ??? ?????????????, ???? ??????? ????? ???? ??????, ?? ???????? ?? ?????? ?????????? ??????????????, ????? ???????? NULL ??? ????????, ?? ??????????????? ??? ???????. ???? app.js ? ???????? ???????? ??????? ????? ????????????? ??? ??????. ???, ??????? ????????? ??????????, ?????? ???? ??????? ?? ?????-???? ??????? Office.JS, ??????? ?????????? ??????? ? ????? ???????, ??????????? ?????????, ??? ? ???? ??????.
   - ??????? jQuery `ready` ?????????? ? ?????? `initialize`. ?????????? ????? ????????????? ???????: ??? ???????? (? ??? ????? ?????????) ??? ????????????? ?? ?????? ????????? JavaScript ?????? ?????????? ? ??????? `Office.initialize`.

    ```js
    (function () {
    "use strict";

        Office.initialize = function() {        
            $(document).ready(function () {  
    
                // TODO1: Assign handler to the OK button.
    
            });
        }

        // TODO2: Create the OK button handler
    
    }());    
    ```

6. ???????? `TODO1` ??????????? ???? ?????. ?? ????????? ??????? `sendStringToParentPage` ?? ????????? ?????.

    ```js
    $('#ok-button').click(sendStringToParentPage);
    ```

7. ???????? `TODO2` ??????????? ???? ?????. ????? `messageParent` ???????? ???? ???????? ???????????? ???????? (? ?????? ?????? ??? ???????? ?? ?????? ?????). ???????? ????? ???? ?????????? ??? ?????????. ?? ?????? ?????? ??????????????? ???, ??? ????? ?????????????, ?????????? ? ???? ?????? (????????, XML ??? JSON). 

    ```js
    function sendStringToParentPage() {
        var userName = $('#name-box').val();
        Office.context.ui.messageParent(userName);
    }
    ```

8. ????????? ????.

   > [!NOTE]
   > ???? popup.html ? ??????????? ?? ???? popup.js ??????????? ? ????????? ????????? ???????? Internet Explorer ?? ??????? ????? ??????????. ???? ???? popup.js ??? ??????? ? ??? ?? ???? bundle.js, ??? ? ???? app.js, ?????????? ???????? ??? ?????????? ????? bundle.js, ? ??? ???????? ???? ???????????. ????? ????, ???? popup.js ?? ???????? ??? JavaScript, ??????? ?? ?????????????? ? IE. ?? ???? ???? ???????? ??? ?????????? ?? ???????? ???? popup.js ??????. 


## <a name="open-the-dialog-from-the-task-pane"></a>???????? ??????????? ???? ?? ??????? ?????

1. ???????? ???? index.html.
2. ??? `div` ? ??????? `freeze-header` ???????? ??????????? ???? ???.

    ```html
    <div class="padding">            
        <button class="ms-Button" id="open-dialog">Open Dialog</button>          
    </div>
    ```

3. ? ?????????? ???? ???????????? ????? ?????????? ?????? ??? ? ???????? ??? ???????????? ? ??????? ?????. ??????? ????? ????????? ??? ? ???????. ??????????????? ??? ?????? ??? ??????????? ????? `div` ???????? ??????????? ???? ???.

    ```html
    <div class="padding">            
        <label id="user-name"></label>            
    </div>
    ```

4. ???????? ???? app.js.

5. ??? ???????, ??????????? ?????????? ??????? ??? ?????? `freeze-header`, ???????? ??????????? ???? ???. ?? ????????? ????? `openDialog` ?? ????? ?? ????????? ?????.

    ```js
    $('#open-dialog').click(openDialog);
    ```

6. ??? ???????? `freezeHeader` ???????? ????????? ???? ??????????. ??? ?????????? ?????????? ?????? ? ????????? ?????????? ???????????? ????????, ??????? ?????? ??????????? ??? ????????? ?????????? ???????? ??????????? ????.

    ```js
    let dialog = null;
    ```

7. ???????? ??????????? ???? ??????? ??? ??????????? `dialog`. ????? ????????, ??? ? ???? ???? *???????????* ????? `Excel.run`. ??? ??????? ? ???, ??? API, ??????????? ?????????? ????, ????????? ???????????? ????? ???????? ???????????? Office, ??????? ????????? ? ?????? API JavaScript ??? Office, ? ?? API ??? Excel.

    ```js
    function openDialog() {
        // TODO1: Call the Office Shared API that opens a dialog
    }
    ``` 

8. ???????? `TODO1` ??????????? ???? ?????. ??????????.
   - ????? `displayDialogAsync` ????????? ?????????? ???? ? ?????? ??????.
   - ?????? ???????? ? ??? URL-????? ??????????? ????????.
   - ?????? ???????? ???????? ?????????. `height` ? `width` ? ?????????? ???????? ??????? ???? ??? ?????????? Office. 
   
    ```js
    Office.context.ui.displayDialogAsync(
        'https://localhost:3000/popup.html',
        {height: 45, width: 55},
        
        // TODO2: Add callback parameter.
    );
    ``` 

## <a name="process-the-message-from-the-dialog-and-close-the-dialog"></a>????????? ????????? ?? ??????????? ???? ? ???????? ??????????? ????

1. ??????????? ???????? ? ????? app.js. ???????? `TODO2` ??????????? ???? ?????. ???????? ????????:
   - ???????? ????? ??????????? ????? ?? ????? ????????? ???????? ??????????? ???? ? ?? ????, ??? ???????????? ?????????? ?????-???? ???????? ? ?????????? ????.
   - ? ??? ??????, ??????? ????????? ? ???????? ?????????? ????? ??????????? ?????????? ???????????? ??????? ? ??????? ?????????? ????.`result.value`
   - ??????? `processMessage` ????? ??????? ?? ????? ??????? ?????. ???? ?????????? ????? ???????????? ????? ????????, ??????? ???????????? ?? ???????? ??????????? ???? ? ???????? ??????? `messageParent`.

    ```js
    function (result) {
        dialog = result.value;
        dialog.addEventHandler(Microsoft.Office.WebExtension.EventType.DialogMessageReceived, processMessage);
    }
    ```

2. ???????? ????????? ???? ??????? ??? ???????? `openDialog`.

    ```js
    function processMessage(arg) {
        $('#user-name').text(arg.message);
        dialog.close();
    }
    ```

## <a name="test-the-add-in"></a>???????????? ??????????

1. ???? ???? Git Bash ??? ????????? ????????? ?????? ? ?????????? Node.JS, ???????? ?? ?????????? ????? ???????????, ??? ??? ???????, ?????? ??????? ??????? CTRL+C, ????? ?????????? ?????? ???-???????. ???? ??? ???????, ???????? ???? Git Bash ??? ????????? ????????? ?????? ? ?????????? Node.JS ? ????????? ? ????? **Start** ???????.

     > [!NOTE]
     > ???? ?????? ????????????? ???????? ????? ???????? ????????? ?????????? ? ??????? ????? ??? ?????? ????????? ?????? ????? (? ??? ????? app.js), ?? ?? ???????? ???????? ??? JavaScript, ??????? ????? ????? ????? ????????? ??????? ??????, ????? ?????????, ????????? ? ???? app.js, ???????? ? ????. ??? ????? ??????? ????????? ??????? ???????, ????? ????? ???? ???????? ??????????? ?? ???? ??????? ??????. ????? ?????? ?????????? ????????????? ??????. ??? ????? ????????? ????????? ???? ????????.

1. ????????? ??????? `npm run build`, ????? ????????????? ???????? ??? ES6 ? JavaScript ????? ?????? ??????, ??????? ???????????? Internet Explorer (???????????? ??????????? Excel ? ??????? ?????? ??? ??????? ????????? Excel).
2. ????????? ??????? `npm start`, ????? ????????? ???-??????, ?????????? ?? localhost.
4. ???????? ????????? ??????? ?????. ??? ????? ???????? ??, ? ????? ???????? ? ???? **???????** ????? **Show Taskpane** (???????? ??????? ?????) ??? ?????????? ???????? ??????????.
6. ??????? ?????? **Open Dialog** (??????? ?????????? ????) ? ??????? ?????. 
7. ????? ?????????? ???? ???????, ?????????? ??? ? ???????? ??? ??????. ???????? ???????? ?? ??, ??? ?? ?????? ???????? ?? ????? ? ???????? ?????? ?????? ? ??????? ?????. ?? ????????? ?????? ?????????? ???? ? ??? ?? ???????? ??????? ????? ??????????.
8. ? ?????????? ???? ??????? ??? ? ??????? ?????? **OK**. ? ??????? ????? ??????????? ???, ? ?????????? ???? ?????????.
9. ??? ??????? ????? ???????????????? ?????? `dialog.close();` ? ??????? `processMessage`. ????????? ???? ????? ???????. ?????????? ???? ???????? ????????, ? ?? ?????? ???????? ???. ????? ??????? ??? ???????, ????? ?????? **X** ? ?????? ???????? ????.

    ![??????????? ?? Excel: ?????????? ????](../images/excel-tutorial-dialog-open.png)


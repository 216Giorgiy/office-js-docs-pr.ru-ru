# <a name="create-add-ins-for-access-web-apps"></a>Создание надстроек для веб-приложений Access

>**Важно!** Больше не рекомендуется создавать и использовать веб-приложения и базы данных Access в SharePoint. В качестве альтернативы рекомендуем использовать [Microsoft PowerApps](https://powerapps.microsoft.com/) для создания бизнес-решений для Интернета и мобильных устройств без написания кода.

В этой статье показано, как с помощью Visual Studio 2015 создать надстройку Office, предназначенную для веб-приложений Access.

>**Примечание.** Дополнительные сведения о разработке решений для Access с помощью VBA см. в статье [Access](https://msdn.microsoft.com/en-us/library/fp179695.aspx) на сайте MSDN.

## <a name="prerequisites"></a>Необходимые компоненты

Чтобы создать Надстройка Office для Веб-приложения Access, вам потребуются:

- Visual Studio 2015

- Сайт SharePoint Online (входит в состав многих подписок на Office 365). Этот сайт должен иметь каталог надстроек. Дополнительные сведения см. в статье [Настройка каталога надстроек в SharePoint](../publish/publish-task-pane-and-content-add-ins-to-an-add-in-catalog.md).


>**Примечание.** Надстройки Office работают с веб-приложениями Access, размещенными в SharePoint Online или Office 365. В классическом приложении Access 2013 надстройки Office не поддерживаются. Надстройки Office для веб-приложений Access поддерживаются в Office.js версии 1.1 и более поздних.


## <a name="create-a-project-in-visual-studio"></a>Создание проекта в Visual Studio

1.  Откройте Visual Studio и в меню выберите **Файл** > **Создать** > **Проект**. Откроется диалоговое окно **Новый проект**.

2. В диалоговом окне **Новый проект**, в области слева, перейдите к разделу **Установленные** > **Шаблоны** > **Visual C#** > **Office/SharePoint** > **Надстройки Office**.

    >**Примечание.**  Если этот шаблон не установлен, установите обновление, описанное в статье [Последние инструменты разработчика Microsoft Office для Visual Studio 2015](https://blogs.msdn.microsoft.com/visualstudio/2015/11/23/latest-microsoft-office-developer-tools-for-visual-studio-2015/).

3. В диалоговом окне **Новый проект**, в области по центру, выберите **Надстройка Office**.

4. В нижней части диалогового окна введите имя проекта и нажмите **ОК**. Откроется диалоговое окно **Создание надстройки Office**.

5. В диалоговом окне **Создание надстройки Office** выберите **контентную** надстройку и нажмите **Далее**.

6. На следующем экране диалогового окна **Создание надстройки Office** выберите **Базовая надстройка** или **Надстройка для визуализации документов**, а затем убедитесь, что установлен флажок **Access**.

7. Когда закончите, нажмите **Готово**. Visual Studio создаст начальный проект, на котором будет основываться дальнейшая работа.

8. В **обозревателе решений** выберите веб-проект (**<имя_проекта> > Web**). В области свойств найдите пункт **URL-адрес SSL**. Он должен выглядеть примерно следующим образом: `https://localhost:44314/`. Выделите этот URL-адрес и скопируйте его в буфер обмена. Вскоре он вам понадобится.

9. Щелкните правой кнопкой мыши имя проекта в **обозревателе решений**. В контекстном меню выберите **Опубликовать**. Откроется мастер **публикации надстройки**.

10. В мастере **публикации надстройки** выберите раскрывающийся список рядом с пунктом **Текущий профиль**. В этом раскрывающемся списке выберите **Создать**. Откроется диалоговое окно **Публикация надстроек Office и SharePoint**.

11. В этом диалоговом окне выберите **Создать новый профиль**, введите имя профиля и нажмите **Готово**. Диалоговое окно **Публикация надстроек Office и SharePoint** закроется, и вы вернетесь в мастер **публикации надстройки**.

12. В мастере выберите **Упаковать надстройку**. После этого надстройка будет готова к публикации в каталоге надстроек SharePoint.

13. На следующей странице, в поле **Где размещен ваш веб-сайт?**, введите URL-адрес узла веб-сайта. Это может быть **URL-адрес SSL**, который вы скопировали на шаге 8. После этого нажмите **Готово**.

14. В **обозревателе решений** щелкните правой кнопкой мыши узел манифеста проекта (сразу под именем проекта) и выберите **Открыть папку в проводнике**. Запишите путь к этому файлу. Это значение потребуется вам позже.

>**Примечание.** Надстройку нельзя отлаживать, не развернув ее в веб-приложении Access.

## <a name="review-the-manifest-and-the-homehtml-file"></a>Проверка манифеста и файла Home.html

1. В проекте Visual Studio откройте файл **Home.html** и найдите строки, ссылающиеся на библиотеку сценариев office.js.

    ```html
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/Office.js" type="text/javascript"></script>
    ```

    >**Примечание.** Этот тег скрипта ссылается на версию Office.js 1.1 (и выше). Access использует элементы API, впервые представленные в версии 1.1.

2. Откройте файл манифеста, связанный с вашим проектом. Его имя будет совпадать с названием проекта, и он будет иметь расширение XML.

3.  Найдите в файле манифеста раздел **Hosts** и строку **Host**.

    ```xml
    <Hosts> <Host Name="Database" /> </Hosts>
    ```
    
    >**Примечание.** Здесь указаны приложения, которые могут использовать надстройку. Так как вы выбрали **Access** в диалоговом окне **Создание надстройки Office**, здесь указано значение **Database**. Если вы бы включили Excel, здесь было бы также указано значение **Workbook**.

Надстройки Office и SharePoint основаны на веб-интерфейсе. Код надстройки должен быть размещен на веб-сервере. В этом примере веб-сервером является компьютер разработчика. Для тестирования надстройки сервер должен быть запущен. В нашем случае во время просмотра и отладки надстройки в SharePoint должен быть запущен Visual Studio.

Чтобы пользователь мог найти и использовать надстройку, необходимо зарегистрировать ее в каталоге надстроек SharePoint. Данные, необходимые для каталога надстроек, указаны в файле манифеста.

>**Примечание.**  Для размещения надстройки Office необходимо создать веб-приложение Access.

## <a name="publish-your-add-in-to-a-sharepoint-online-catalog"></a>Публикация надстройки в каталоге SharePoint Online

1.  Войдите в SharePoint Online или Office 365 и перейдите в **Центр администрирования SharePoint**, нажав **Администратор** на панели инструментов Office 365 в верхней части страницы.

2. На странице **Центр администрирования SharePoint**, в панели ссылок слева, выберите **Надстройки**. Откроется список надстроек.

3. В центральной области страницы выберите **Каталог надстроек**. Откроется страница **Каталог**.

4. На странице **Каталог** выберите **Распространение надстроек для Office**. Откроется страница каталога под названием **Надстройки Office**, на которой перечислены все установленные Надстройки Office.

5. В верхней части страницы **Надстройки Office** выберите **Новая надстройка**. Откроется диалоговое окно **Добавление документа**.

6. В диалоговом окне **Добавление документа** выберите **Обзор** и перейдите к папке с файлом манифеста в проекте Visual Studio. Если вы скопировали адрес файла манифеста, можете вставить его в это диалоговое окно.

7. Выберите файл манифеста в проекте и нажмите **ОК**. Теперь SharePoint добавит надстройку в локальную библиотеку SharePoint.

>**Примечание.**  Для выполнения следующей процедуры нужен тестовый сайт SharePoint. Его можно создать на вкладке **Сайты** в верхней части окна SharePoint. Если у вас есть веб-приложение Access, можете использовать его.

## <a name="create-an-access-web-app-to-host-your-add-in"></a>Создание веб-приложения Access для размещения надстройки

1. Перейдите на тестовый сайт. В панели ссылок слева выберите **Содержимое сайта**. Откроется страница содержимого тестового сайта.

2. На этой странице выберите **Добавить надстройку**. Откроется страница **Содержимое сайта — Ваши надстройки**.

3. В верхней части этой страницы, в строке поиска, введите **Приложение Access**.

4. Появится плитка **Приложение Access**.

    >**Примечание.**  Помните, что это не ваша надстройка Office, а новое веб-приложение Access. В нем будет размещаться ваша надстройка.

5. Выберите эту плитку. Откроется диалоговое окно **Добавление приложения Access**. Введите уникальное имя для этого приложения и выберите **Создать**. Создание приложения может занять некоторое время. Когда этот процесс закончится, ваше приложение Access появится на странице **Содержимое сайта** с пометкой **новое**.

6. Теперь нужно открыть приложение для Access в классической версии Microsoft Access 2013 и добавить данные, чтобы их можно было открывать и просматривать в SharePoint.

## <a name="add-your-add-in-to-an-access-web-apps"></a>Добавление надстройки в Веб-приложения Access

1. Откройте веб-приложение Access.

2. На панели вкладок SharePoint выберите значок шестеренки в левом верхнем углу. Откроется контекстное меню. Выберите элемент меню **Надстройки Office**. Откроется диалоговое окно **Надстройки Office**.

3. Выберите представление **Моя организация** и подождите, пока SharePoint заполнит диалоговое окно доступными вам Надстройки Office.

4. В диалоговом окне среди надстроек должна находиться и надстройка Office, которая была зарегистрирована при выполнении предыдущей процедуры.  Выберите эту надстройку, чтобы вставить в свой список веб-приложений Access. Помните, что для обнаружения и отображения на странице веб-приложений Access данное приложение должно быть запущено в Visual Studio.

## <a name="debug-your-add-in-for-office"></a>Отладка надстройки Office

Для отладки надстройки в Internet Explorer нажмите клавишу F12 или значок шестеренки на панели вкладок браузера (не тот значок шестеренки, который отображается на странице SharePoint). Откроются средства отладки Internet Explorer 11. Если вы используете другой браузер, ознакомьтесь с документацией по нему, чтобы узнать, как включить режим отладки.

Теперь вы можете устанавливать точки останова, пошагово выполнять код JavaScript, изучать DOM и изменять код, чтобы убедиться, что изменения отображаются в надстройке Office, предназначенной для веб-приложений Access. Дополнительные сведения см. в статье [Использование средств разработчика F12](http://msdn.microsoft.com/library/ie/bg182326%28v=vs.85%29).

## <a name="next-steps"></a>Дальнейшие действия

Скачайте пример [Office 365. Привязка данных и управление ими в веб-приложении Access](https://code.msdn.microsoft.com/officeapps/Office-365-Bind-and-4876274e), чтобы узнать больше о том, как реализовать Надстройка Office, которая управляет данными в Веб-приложение Access.

## <a name="additional-resources"></a>Дополнительные ресурсы

- [Общие сведения об API JavaScript для надстроек](../develop/understanding-the-javascript-api-for-office.md)

- [API JavaScript для Office](../../reference/javascript-api-for-office.md)

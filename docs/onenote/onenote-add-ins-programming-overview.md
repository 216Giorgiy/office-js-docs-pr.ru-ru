---
title: ????? ???????? ???? ? ??????? API JavaScript ??? OneNote
description: ''
ms.date: 01/23/2018
ms.openlocfilehash: aded1210abc11a80c6200a207d3896df8ef4218b
ms.sourcegitcommit: c72c35e8389c47a795afbac1b2bcf98c8e216d82
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/23/2018
---
# <a name="onenote-javascript-api-programming-overview"></a>????? ???????? ???? ? ??????? API JavaScript ??? OneNote

? OneNote ??????????? API JavaScript ??? ????????? OneNote Online. ?? ?????? ????????? ?????????? ??????? ?????, ?????????? ?????????? ? ??????? ?????????, ??????? ??????????????? ? ????????? OneNote ? ???????????? ? ???-??????? ??? ?????? ???-????????.

> [!NOTE]
> ???? ?? ?????????? [????????????](../publish/publish.md) ?????????? ? AppSource ? ??????? ?? ????????? ? ?????????? Office, ?????????, ??? ??? ????????????? [????????? ???????? AppSource](https://docs.microsoft.com/en-us/office/dev/store/validation-policies). ????????, ????? ?????? ????????, ?????????? ?????? ???????? ?? ???? ??????????, ?????????????? ???????????? ???? ??????. ?????????????? ???????? ??. ? [??????? 4.12](https://docs.microsoft.com/en-us/office/dev/store/validation-policies#4-apps-and-add-ins-behave-predictably) ? ?? [???????? ?? ?????????? ? ??????????? ? ??????? ??????????? ??? ????????? Office](../overview/office-add-in-availability.md).

## <a name="components-of-an-office-add-in"></a>?????????? ?????????? Office

?????????? ??????? ?? ???? ????????? ???? ???????? ???????????.

- **???-??????????**, ????????? ?? ???-???????? ? ??????????? JavaScript-, CSS- ??? ?????? ??????. ??? ????? ????? ?????????? ?? ???-??????? ??? ? ?????? ???-????????, ???????? ? Microsoft Azure. ? OneNote Online ???-?????????? ???????????? ? ???????? ?????????? ???????? ??? ? iFrame.
    
- **???????? ? ??????? XML**, ? ??????? ?????? URL-????? ???-???????? ?????????? ? ??? ??????????, ??????????? ??? ????????? ???????, ????????? ? ??????????? ??? ??????????. ???? ???? ???????? ?? ?????????? ??????????. ??? ????????? OneNote ???????????? ????? ?? ?????? [?????????](../develop/add-in-manifests.md), ??? ? ??? ?????? ????????? Office.

**?????????? Office = ???????? + ???-????????**

![?????????? Office ??????? ?? ????????? ? ???-????????](../images/onenote-add-in.png)

## <a name="using-the-javascript-api"></a>????????????? API JavaScript

??? ??????? ? API JavaScript ?????????? ?????????? ???????? ????? ?????????? ???????? ??????????. API ??????? ?? ???? ????????? ???? ???????. 

- **??????????????????? API** ??? ????????? ? OneNote ????????, ?????? ? ???????? ?????????????? ? ??????? ??????? **Application**.
- **??????????? API**, ???????????? ???????????? Office, ?????? ? ???????? ?????????????? ? ??????? ??????? **Document**.

### <a name="accessing-the-rich-api-through-the-application-object"></a>?????? ? ???????????????????? API ? ??????? ??????? *Application*

??? ??????? ? ???????? OneNote, ???????? ? ???????? **Notebook**, **Section** ? **Page**, ??????????? ?????? **Application**. ? ??????? ??????????????????? API ?? ?????? ????????? ???????? ???????? ?? ??????-????????. ???????? ??????? ???????? ???????? ???, ??? ??????? ????. 

1. ????????? ?????????? ?????????? ?? ?????????.

2. ???????? ??????-???????, ??????????????? ?????? OneNote, ? ??????? ??? ?????????? ????????. ??? ??????????? ?????????????? ? ??????-????????? ????? ????????? ? ?????????? ?? ???????? ? ???????? ????????? ? ??? ??????. 

3. ???????? ????? **load** ??????-???????, ????? ??????? ??? ???? ???????? ???????, ????????? ? ?????????. ???? ????? ????? ???????? ? ??????? ??????.

   > [!NOTE]
   > ??????, ??????? ?????? ????????? ? API (????????, `context.application.getActiveSection().pages;`), ????? ??????????? ? ???????.

4. ????? ????????? ??? ???????????? ? ??????? ??????? ? ??? ???????, ? ??????? ??? ????????? ? ???????, ???????? ????? **context.sync**. ???? ????? ?????????????? ????????? ????????????? ????????? ? ???????? ????????, ? ????? ???????? ???????? ??????????? ???????? OneNote, ??????? ?????????? ???????????? ? ????????. ?? ?????? ???????????? ???????????? ?????? ???????? ??? ?????????? ?????????????? ???????? ? ???????.

???????: 

```js
function getPagesInSection() {
    OneNote.run(function (context) {
        
        // Get the pages in the current section.
        var pages = context.application.getActiveSection().pages;
        
        // Queue a command to load the id and title for each page.            
        pages.load('id,title');
        
        // Run the queued commands, and return a promise to indicate task completion.
        return context.sync()
            .then(function () {
                
                // Read the id and title of each page. 
                $.each(pages.items, function(index, page) {
                    var pageId = page.id;
                    var pageTitle = page.title;
                    console.log(pageTitle + ': ' + pageId); 
                });
            })
            .catch(function (error) {
                app.showNotification("Error: " + error);
                console.log("Error: " + error);
                if (error instanceof OfficeExtension.Error) {
                    console.log("Debug info: " + JSON.stringify(error.debugInfo));
                }
            });
    });
}
```

???????? ? ?????????????? ???????? ? ????????? OneNote ??. ? [??????????? ?? API](https://dev.office.com/reference/add-ins/onenote/onenote-add-ins-javascript-reference).

### <a name="accessing-the-common-api-through-the-document-object"></a>????????? ??????? ? ???????????? API ? ??????? ??????? *Document*

??? ??????? ? ???????????? API, ???????? ? ??????? **getSelectedDataAsync** ? [setSelectedDataAsync](https://dev.office.com/reference/add-ins/shared/document.getselecteddataasync), ??????????? ?????? [Document](https://dev.office.com/reference/add-ins/shared/document.setselecteddataasync). 

????????:  

```js
function getSelectionFromPage() {
    Office.context.document.getSelectedDataAsync(
        Office.CoercionType.Text,
        { valueFormat: "unformatted" },
        function (asyncResult) {
            var error = asyncResult.error;
            if (asyncResult.status === Office.AsyncResultStatus.Failed) {
                console.log(error.message);
            }
            else $('#input').val(asyncResult.value);
        });
}
```
?????????? OneNote ???????????? ?????? ????????? ???? ??????????? API.

| API | ?????????? |
|:------|:------|
| [Office.context.document.getSelectedDataAsync](https://dev.office.com/reference/add-ins/shared/document.getselecteddataasync) | ?????? **Office.CoercionType.Text** ? **Office.CoercionType.Matrix** |
| [Office.context.document.setSelectedDataAsync](https://dev.office.com/reference/add-ins/shared/document.setselecteddataasync) | ?????? **Office.CoercionType.Text**, **Office.CoercionType.Image** ? **Office.CoercionType.Html** | 
| [var mySetting = Office.context.document.settings.get(???);](https://dev.office.com/reference/add-ins/shared/settings.get) | ????????? ?????????????? ?????? ??????????? ???????????? | 
| [Office.context.document.settings.set(???, ????????);](https://dev.office.com/reference/add-ins/shared/settings.set) | ????????? ?????????????? ?????? ??????????? ???????????? | 
| [Office.EventType.DocumentSelectionChanged](https://dev.office.com/reference/add-ins/shared/document.selectionchanged.event) ||

? ????? ?????? ??????????? API ??????? ???????????? ?????? ?????, ????? ??????????? ??????????? ?? ?????????????? ? ??????????????????? API. ?????????????? ???????? ?? ????????????? ???????????? API ??. ? [????????????](../overview/office-add-ins.md) ? [???????????](https://dev.office.com/reference/add-ins/javascript-api-for-office) ?? ??????????? Office.


<a name="om-diagram"></a>
## <a name="onenote-object-model-diagram"></a>????? ????????? ?????? OneNote 
?? ????? ???? ???????? ???????????, ??????? ?? ?????? ?????? ???????? ? API JavaScript ??? OneNote .

  ![????? ????????? ?????? OneNote](../images/onenote-om.png)


## <a name="see-also"></a>??. ?????

- [???????? ?????? ?????????? OneNote](onenote-add-ins-getting-started.md)
- [?????????? ?? API JavaScript ??? OneNote](https://dev.office.com/reference/add-ins/onenote/onenote-add-ins-javascript-reference)
- [?????? ?????????? Rubric Grader](https://github.com/OfficeDev/OneNote-Add-in-Rubric-Grader)
- [????? ????????? ????????? Office](../overview/office-add-ins.md)
